{"version":3,"sources":["common/ColStyle.tsx","forms/FormTextInput.tsx","hooks/useShopStatus.ts","hooks/useEmptyOrderRedirect.ts","common/ShopAddress.tsx","common/BackgroundThemed.tsx","segments/map/hooks/usePickupMapQuery.ts","common/BaseMap.tsx","segments/foodMenu/hooks/useFoodMenuQuery.ts","segments/orderForm/OrderFormSetup.tsx","segments/timePicker/TimePickerButton.tsx","segments/timePicker/TimePicker.tsx","segments/orderForm/OrderTimePicker.tsx","hooks/useDelayedOrder.ts","hooks/useLoadingCache.ts","common/LanguagePicker.tsx","segments/shop/ShopClosingTimeModal.tsx","segments/shop/ShopHeaderIcons.tsx","segments/shop/ShopStatusDisplay.tsx","segments/finish/FinishViewFooter.tsx","segments/finish/FinishViewLoader.tsx","segments/finish/FinishViewOrder.tsx","segments/finish/FinishViewSupport.tsx","common/ButtonStripe.tsx","segments/map/hooks/useMapPanning.ts","common/MapBranchMarker.tsx","hooks/useAddToCart.ts","common/PickerButton.tsx","common/ButtonStrip.tsx","segments/orderForm/OrderErrorModal.tsx","segments/orderForm/OrderFormAutoFill.tsx","segments/orderForm/hooks/useOrderFormCheck.ts","segments/orderForm/hooks/useOrderPayment.ts","segments/orderForm/OrderFormTipInput.tsx","segments/orderForm/OrderGoPayModal.tsx","segments/orderForm/OrderPromoInput.tsx","segments/orderForm/OrderSubmitButton.tsx","segments/orderForm/OrderTimeButtons.tsx","segments/orderForm/OrderFormStorageNotice.tsx","segments/map/AddressSubmit.tsx","segments/map/destination/AddressSearchInput.tsx","hooks/useDebounce.ts","segments/map/destination/GeolocationButton.tsx","segments/map/destination/ResolvedAddress.tsx","segments/map/hooks/useAddressSearch.ts","segments/map/ExtraAddressResult.tsx","segments/map/DeliveryAddressSearch.tsx","segments/map/DeliveryMap.tsx","hooks/useLocationResolver.ts","segments/map/hooks/useDeliveryMapPanning.ts","segments/sidedishPicker/CategoryValidationMessage.tsx","segments/sidedishPicker/SidedishRemoveButton.tsx","segments/sidedishPicker/SidedishCheckbox.tsx","segments/sidedishPicker/SidedishPicker.tsx","segments/cart/CartOrderButton.tsx","segments/cart/CartModal.tsx","segments/cart/AddToCartModal.tsx","segments/cart/ChangeCartModal.tsx","segments/cart/CartView.tsx","segments/foodMenu/CategoryNavigator.tsx","segments/foodMenu/FoodCategory.tsx","segments/foodMenu/FoodMenuItem.tsx","segments/foodMenu/FoodMenu.tsx","segments/foodMenu/hooks/useFoodMenuPresence.ts","segments/foodMenu/OrderLimitModal.tsx","segments/foodMenu/OrderLocked.tsx","segments/foodMenu/FoodMenuView.tsx","segments/orderForm/OrderEmailInput.tsx","segments/orderForm/OrderNameInput.tsx","segments/orderForm/OrderNoteInput.tsx","segments/orderForm/OrderPhoneInput.tsx","segments/orderForm/OrderFormInputs.tsx","forms/FormCheckbox.tsx","segments/orderForm/OrderAgreementBox.tsx","segments/orderForm/OrderAgreements.tsx","segments/cart/CartSystem.tsx","segments/cart/hooks/useCartControl.ts","segments/map/destination/OrderMethodButton.tsx","segments/map/destination/OrderMethod.tsx","segments/orderForm/OrderPaymentButton.tsx","segments/orderForm/OrderPaymentMethod.tsx"],"names":["ColStyle","children","className","sm","md","lg","xl","ColStyleLeft","ColStyleRight","hiddenError","FormTextInput","observer","name","label","errorForceDisplay","element","orderModel","useOrderModel","useXFieldForInput","field","getFieldProps","labelNode","for","hidden","placeholder","showError","touched","type","valid","error","invalid","Boolean","disabled","disableInteraction","tooltip","useShopStatus","status","updateInterval","SECOND","openSoonThresholdInMinutes","closeSoonThresholdInMinutes","getNow","useNow","useTimer","interval","enabled","now","isOpen","willCloseAt","willOpenAt","openingIn","differenceInMinutes","closingIn","decision","isSoon","closedNote","currentInterval","time","threshold","Math","abs","useEmptyOrderRedirect","root","useRoot","history","useRouterContext","useWhen","initialized","hasOrder","push","ShopAddress","address","location","street","houseNumber","city","BackgroundThemed","imageName","fallbackColor","fixed","size","component","otherProps","React","createElement","styled","props","theme","usePickupMapQuery","branchId","business","useQPickupMap","branchSpecific","isBrand","brandId","skip","isValid","fetchPolicy","context","noBatch","getMapOptions","isMobile","streetViewControl","mapTypeControl","fullscreenControl","clickableIcons","draggableCursor","minZoom","zoomControlOptions","position","google","maps","ControlPosition","RIGHT_CENTER","RIGHT_TOP","libraries","BaseMap","model","user","useLoadScript","id","version","googleMapsApiKey","appConfig","googleMapsApi","language","isLoaded","loadError","googleMapUrl","url","googleAvailable","Reflect","has","window","Sentry","withScope","scope","setExtras","captureException","zoom","center","onCenterChanged","updatePosition","onZoomChanged","updateZoom","onClick","onLoad","setMapRef","onUnmount","options","mapContainerStyle","borderRadius","overflow","height","noMargin","useFoodMenuQuery","result","useQFoodMenu","useReaction","refetch","NOTE_MAX_LENGTH","OrderFormSetup","useOrderPayment","executeGoPayPayment","paymentErrorModal","useMSubmitOrder","submitOrder","validationSchema","useMemo","createObjectValidation","Yup","firstname","string","required","lastname","phonePrefix","phone","matches","email","note","notRequired","max","value","length","isOrderInCart","useOrderFormCheck","useEffect","replace","onSubmit","useCallback","values","a","submitStarted","variables","getSubmitVariables","submitFailed","userErrors","gopayUrl","paymentMethod","PaymentGateEnum","Cash","submitFinished","Gopay","finally","captureMessage","xform","useXForm","initialValues","agreements","onFormChanges","console","log","cart","setOrderSubmitting","state","isSubmitting","handlers","handleSubmit","orderId","customer","firstName","lastName","emails","phones","tips","paymentGate","deliverAt","isoDate","Time","div","TimePickerButton","buttonProps","PickerButton","outline","width","data-testid","getTime","formatTime","TimePickerContainer","TimePickerDay","TimePicker","rawSteps","steps","initialTime","onStepChange","filtered","filter","isAfter","RM","sort","ascend","invoker","days","uniq","map","startOfDay","useState","stepIdx","setStepIdx","DF","closestIndexTo","day","key","getDate","format","month","weekday","step","idx","isEqual","isSelected","canBeSelected","OrderTimePicker","order","useDelayedOrder","getSteps","canBeDelayed","changeDeliveryTime","selectedTime","useRef","current","onConfirmAndClose","closeTimePicker","header","usingDeliveryOrderMethod","i18n","timePickerOpen","toggle","autoFocus","backdrop","fade","ModalHeader","tag","Container","ModalBody","STEP_SIZE_MINUTES","getData","shouldSkip","cached","loading","getNext","next","useLoadingCache","useQDelayedOrder","data","cachedData","delayedOrder","intervals","flatten","createTimeSteps","useMOrderDeliveryTime","updateOrder","withGoods","setDeliverAt","isEnabled","minuteStep","start","end","startOfMinute","toDate","addMinutes","subMinutes","getMinutes","timeClampDown","endMinute","endOfMinute","LanguagePicker","availableLanguages","branch","supportedLanguages","selectedLanguage","onChange","selectLanguage","setTimeout","reload","backgroundColor","arrowColor","ShopClosingTimeModal","isDelayed","closingTimeAlertHidden","onClose","hideClosingTime","headerText","openTimePicker","ShopHeaderIcons","src","getLogo","alt","StyledStatusDisplayOpen","span","StyledStatusDisplayClosed","ShopStatusDisplay","deliveryTime","pickupTime","closestBH","businessHours","timingDisplay","defaultDeliveryTimeEnabled","usingPickupOrderMethod","defaultPickupTimeEnabled","path","render","formatOpenTime","openAt","openAtDate","Date","nowDate","hour","minute","isSameDay","CenteredButtonContainer","FinishViewFooter","finish","androidApp","iosApp","renderHomeButton","to","href","color","style","textAlign","FinishViewLoader","useQOrderFinish","HeaderThemed","primary","PriceThemed","PriceCornerThemed","FinishViewOrder","orderPayments","some","hasMethod","PaymentTypeEnum","Credit","getPaymentInfo","items","item","OrderItem","totalSum","getPaymentPrice","formattedValue","paymentType","payment","enum","recipe","sideDishes","nameLabel","join","PhoneNumberLinkStyled","FinishViewSupport","ButtonStripe","useMapPanning","mapRef","useGoogleMap","prevGps","gps","prev","latitude","longitude","latLng","gpsToLatLngLit","panTo","panToGps","StyledPickupMapMarker","MapBranchMarker","gpsToLatLng","mapPaneName","OverlayView","OVERLAY_MOUSE_TARGET","getPixelPositionOffset","x","y","title","counter","NO_SIDEDISHES","useAddToCart","cartModel","client","useApolloClient","useMAddToCart","addToCart","recipeId","withPresence","optimisticResponse","makeOptimisticResponse","readQuery","query","QCartDocument","__typename","add","countWares","readFragment","fragment","FRecipeFragmentDoc","fragmentName","automatic","price","addItem","presence","PickerButtonStyled","tertiary","tertiaryText","tertiaryHover","onSelect","StyledButtonStrip","mediaMobile","ButtonStrip","OrderErrorModal","useObserver","hasErrors","clearErrors","submitErrors","OrderFormAutoFill","useXFormCtx","useQOrderForm","orderStateCategory","OrderStateCategoryEnum","InCart","hasItemsInCart","useAlertModal","alertPaymentError","useExecutableQOrderPaymentStatus","executePaymentStatusCheck","onFinish","onError","errors","queryPaymentStatus","userToken","goPayStatusCheck","invalidateWithToken","then","Promise","resolve","useGoPay","paymentProcessing","paymentLoading","StyledOrderFormTipInput","OrderFormTipInput","useMOrderTipUpdate","updateTip","usingPaymentMethodWithTips","Number","ev","setTips","parseInt","target","TextPadding","OrderGoPayModal","isGoPayChecking","CodesPanel","OrderPromoInput","memo","errorModal","useQOrderPromoCodes","useMOrderPromoAdd","addCodeMutation","useMOrderPromoRemove","removeCodeMutation","onCodeAdd","code","onCodeRemove","codeId","useOrderPromoCodes","onCodeErrors","msg","getValidatingMessage","inputProps","inputRef","codes","promoCodes","innerRef","autoComplete","role","OrderSubmitButton","submitBlocked","submitBlockReason","isVamInitialized","fadeIn","StyledOrderTimeButtons","OrderTimeButtons","selected","NoticeButton","Button","StorageNotice","Alert","mediaDesktop","OrderFormStorageNotice","rememberForm","setFormRememberYes","setFormRememberNo","AddressSubmit","AddressSearchInput","onSearch","isVisible","focus","onSearchDebounced","cb","deps","debounced","debounce","clear","useDebounce","Input","cn","search","setSearchValue","trim","clearAddress","onKeyPress","onFocus","select","searchValue","GeolocationButton","alert","makeAlert","isGeolocationAvailable","isResolving","navigator","geolocation","getCurrentPosition","coords","accuracy","setGeolocationPoint","err","disableGeolocation","enableHighAccuracy","maximumAge","ResolvedAddress","onValidClick","wait","undefined","urlCache","Map","useAddressSearch","count","watchLocation","useLocalStore","results","phrase","searching","params","doFetch","get","fetch","resp","json","validateResult","mapResult","set","debouncedFetch","nextPhrase","reaction","userData","category","suggestFirstRow","suggestSecondRow","suffix","municipality","district","country","find","Styled","ExtraAddressResult","open","hasSearchValue","usefulResults","bounceInLeft","bounceIn","toString","setSearchResult","secondary","DeliveryAddressSearch","setIsResolving","setAsNotResolved","singleResult","startsWith","setAsNotAddress","resetResolution","hasAddress","ErrorMessage","hasResolutionResult","isResolved","isStreetAddress","inDeliveryLocation","StyledDeliveryMap","DeliveryMap","onConfirm","resolver","useExecutableQResolveLocation","resolveLocation","resolutionTarget","setResolutionResult","useLocationResolver","resolveUserLocation","setLocation","hasLocation","geoPoint","clickPoint","clearClickPoint","isDeliveryAddress","useQInitialDeliveryLocation","source","useAsObservableSource","initial","useAutorun","geolocationPoint","gpsCoordinates","useDeliveryMapPanning","createDeliveryOrder","useOrderCreate","draggable","onDragEnd","latLngToGps","CategoryValidationMessage","minCount","maxCount","message","_","StyledSidedishRemoveButton","primaryHover","SidedishRemoveButton","StyledSidedishCheckbox","SidedishCheckbox","sidedish","canBeRemoved","onAdd","onRemove","StyledSidedishPicker","SidedishPicker","selection","useSideDishValidator","categories","isCategoryValid","i","includes","CartOrderButton","isConfirming","setConfirming","heartBeat","every","catch","EMPTY_SELECTION","CartModal","isLoading","initialSideDishes","updateSelection","onCloseModal","onAddSidedish","sidedishId","sel","append","onRemoveSidedish","remove","indexOf","Pacman","descriptionLabel","AddToCartModal","addToCartRecipeId","useQCartRecipe","executeAddToCart","ChangeCartModal","itemId","changeCartItemId","useQCartItem","useMChangeCartItem","changeItem","changeCartItem","sideDishesSelection","CartView","isReadonly","CartSystem","StyledCategoryNavigator","CategoryNavigator","activeCategoryIndex","setActiveCategoryIndex","Link","active","onSetActive","offset","smooth","spy","pictogram","Truncate","lines","FoodCategoryStyled","FoodCategoryTitleStyled","Element","StyledFoodMenuItem","FoodMenuItemImage","img","FoodMenuItemPriceCorner","FoodMenuItemPrice","FoodMenuItem","onAddToCart","hasSideDishes","sideDishCount","useExecutableQCartRecipe","prefetchFoodItem","onMouseEnter","previousPresence","lastActiveRecipeId","image","recipePresence","pulse","zoomIn","renderPresence","StyledFoodMenu","config","useQFoodMenuCartPresence","observable","runInAction","forEach","useFoodMenuPresence","hasSideDish","orderItemsMax","showOrderLimit","setUsedRecipeId","recipes","OrderLimitModal","AlertModal","orderLimitAlertHidden","hideOrderLimit","StyledOrderLocked","OrderLocked","StyledMobileHeader","FoodMenuView","wareCategories","cat","OrderEmailInput","FormGroup","OrderNameInput","InputGroup","OrderNoteInput","ingredientsDescription","FormText","OrderPhoneInput","isMobileSafari","UAParser","userAgent","getBrowser","prefixField","useXFieldState","prefix","defaultPhonePrefix","memoryApplied","setValue","setTouched","OrderFormInputs","StyledFormCheckbox","StyledOrderAgreementBox","OrderAgreementBox","agreement","isCollapsed","titleNode","descriptionNode","onInvalid","setCustomValidity","isMandatory","htmlFor","toLocaleLowerCase","Collapse","EMPTY_ARRAY","OrderAgreements","formState","useXFormState","setVariables","updateVariablesLater","dispose","autorun","input","extractVariables","useQOrderFormAgreements","hasFailed","initVam","useVamAgreements","renderVamAgreements","validate","confirmedAgreements","useXField","confirmed","Array","from","AgreementBox","StyledCartSystem","isMobileConfirm","useTheme","labels","getCartLabels","onItemEdit","useMRemoveCartItem","removeItem","onItemRemove","makeOptimisticRemove","onPlaceOrder","onChangeOrder","rejectItem","reject","idPropEq","useCartControl","renderMobileSubmit","shouldPlaceOrder","renderGoodsLoading","useCartSystem","colors","sumRowBg","sumRowText","mobileSummaryItemCount","mobileBreakpoint","backgroundImage","backgroundCart","updateDisplay","store","showGoods","useQCart","updateSummary","updateGoods","renderCart","noSideDish","noCost","cartSumHeader","totalPrice","emptyCart","totalDiscount","coverPrice","transportFee","tip","minimalOrderPrice","OrderMethodButton","orderMethod","useOrderMethod","data-testselected","StyledOrderMethod","OrderMethod","identity","DeliveryTypeEnum","Messenger","Pickup","OrderPaymentButton","setPaymentMethod","Checkmark","show","StyledOrderPaymentMethod","OrderPaymentMethod"],"mappings":"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","file":"static/js/1.d8784103.chunk.js","sourcesContent":["import React from 'react'\nimport { Col } from 'reactstrap'\n\nexport const ColStyle = ({ children }) => (\n  <Col className=\"pl-sm-0\" sm=\"12\" md=\"12\" lg=\"10\" xl=\"8\">\n    {children}\n  </Col>\n)\n\nexport const ColStyleLeft = ({ children }) => (\n  <Col className=\"pl-sm-0\" sm=\"8\" md=\"8\" lg=\"6\" xl=\"5\">\n    {children}\n  </Col>\n)\n\nexport const ColStyleRight = ({ children }) => (\n  <Col className=\"pl-sm-0\" sm=\"4\" md=\"4\" lg=\"4\" xl=\"3\">\n    {children}\n  </Col>\n)\n","import { useXFieldForInput } from '@speedlo/xform'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport { FormFeedback, Input, Label } from 'reactstrap'\n\nimport { useOrderModel } from '../hooks/useOrderModel'\n\ninterface IProps extends React.InputHTMLAttributes<HTMLInputElement> {\n  name: string\n  label?: string\n  errorForceDisplay?: boolean\n}\n\nexport const hiddenError = '<hidden>'\n\nexport const FormTextInput = observer<IProps>(\n  ({ name, label, errorForceDisplay = false, ...element }) => {\n    const orderModel = useOrderModel()\n    const [field, getFieldProps] = useXFieldForInput(name)\n\n    const labelNode = (\n      <Label for={name} hidden={!label}>\n        {element.placeholder || label}\n      </Label>\n    )\n\n    const showError = errorForceDisplay || field.touched\n\n    return (\n      <>\n        {labelNode}\n        <Input\n          {...getFieldProps()}\n          {...element}\n          type=\"text\"\n          valid={field.touched && !field.error}\n          invalid={showError && Boolean(field.error)}\n          disabled={orderModel.disableInteraction}\n        />\n        {showError && field.error !== hiddenError ? (\n          <FormFeedback valid={false} tooltip={false}>\n            {field.error}\n          </FormFeedback>\n        ) : null}\n      </>\n    )\n  },\n)\n","import { SECOND, useNow, useTimer } from '@speedlo/hooks'\nimport { differenceInMinutes } from 'date-fns'\n\nimport { FCompanyBranchStatusFragment } from '../graph/generated'\n\nexport type TStatus = FCompanyBranchStatusFragment\n\nexport type TStatusDecision = 'Open' | 'Closed' | 'ClosingSoon' | 'OpeningSoon'\n\ninterface IProps {\n  status: TStatus\n  updateInterval?: number\n  openSoonThresholdInMinutes?: number\n  closeSoonThresholdInMinutes?: number\n  onRefresh?(): void\n}\n\nexport interface IShopStatus {\n  decision: TStatusDecision\n  openingIn: number\n  closingIn: number\n  closedNote: Maybe<string>\n}\n\nexport function useShopStatus({\n  status,\n  updateInterval = 30 * SECOND,\n  openSoonThresholdInMinutes = 15,\n  closeSoonThresholdInMinutes = 30,\n}: IProps) {\n  const getNow = useNow()\n\n  useTimer({\n    interval: updateInterval,\n    enabled: updateInterval > 0,\n  })\n\n  const now = getNow()\n  const { isOpen, willCloseAt, willOpenAt } = status\n\n  let decision: TStatusDecision\n\n  const openingIn = willOpenAt ? differenceInMinutes(willOpenAt, now) : 0\n  const closingIn = willCloseAt ? differenceInMinutes(willCloseAt, now) : 0\n\n  if (isOpen) {\n    if (willCloseAt && closingIn <= 0) {\n      decision = 'Closed'\n    } else {\n      decision = isSoon(willCloseAt, closeSoonThresholdInMinutes, now)\n        ? 'ClosingSoon'\n        : 'Open'\n    }\n  } else {\n    if (willOpenAt && openingIn <= 0) {\n      decision = 'Open'\n    } else {\n      decision = isSoon(willOpenAt, openSoonThresholdInMinutes, now)\n        ? 'OpeningSoon'\n        : 'Closed'\n    }\n  }\n\n  const closedNote = status.currentInterval\n    ? status.currentInterval.closedNote\n    : null\n\n  const shopStatus: IShopStatus = {\n    decision,\n    openingIn,\n    closingIn,\n    closedNote,\n  }\n  return shopStatus\n}\n\nfunction isSoon(time: Maybe<string>, threshold: number, now: Date) {\n  return time ? Math.abs(differenceInMinutes(time, now)) <= threshold : false\n}\n","import { useRouterContext, useWhen } from '@speedlo/hooks'\n\nimport { useRoot } from '../app/useRoot'\nimport { useOrderModel } from './useOrderModel'\n\nexport function useEmptyOrderRedirect() {\n  const root = useRoot()\n  const orderModel = useOrderModel()\n  const { history } = useRouterContext()\n\n  useWhen(\n    () => root.initialized,\n    () => {\n      if (!orderModel.hasOrder) {\n        history.push('/')\n      }\n    },\n  )\n}\n","import React from 'react'\n\nimport { FAddressFragment } from '../graph/generated'\nimport { i18n } from '../i18n'\n\ninterface IProps {\n  address: Maybe<FAddressFragment>\n}\n\nexport const ShopAddress: React.FC<IProps> = ({ address }) => {\n  if (!address || !address.location) {\n    return <span>{i18n.t`Unknown address`}</span>\n  }\n  const { location } = address\n  return (\n    <span>{`${location.street} ${location.houseNumber},\\n ${\n      location.city\n    }`}</span>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components/macro'\n\ninterface IProps {\n  imageName: string\n  className?: string\n  fallbackColor?: string\n  fixed?: boolean\n  size?: 'cover' | 'contain' | 'inherit'\n  children?: any\n  component?: any\n}\n\nexport const BackgroundThemed: React.FC<IProps> = ({\n  imageName,\n  fallbackColor = '#5b453c',\n  fixed = false,\n  size = 'inherit',\n  children,\n  component = 'div',\n  ...otherProps\n}) =>\n  React.createElement(\n    styled(component)`\n      background-image: ${props => `url(${props.theme[imageName]})`};\n      background-attachment: ${props => (fixed ? 'fixed' : 'inherit')};\n      background-repeat: no-repeat;\n      background-position: left top;\n      background-size: ${props => size};\n    `,\n    otherProps,\n    children,\n  )\n\nexport default BackgroundThemed\n","import { useRoot } from '../../../app/useRoot'\nimport { useQPickupMap } from '../../../graph/generated'\n\nexport function usePickupMapQuery(branchId?: ID) {\n  const { business } = useRoot()\n  return useQPickupMap(\n    {\n      branchSpecific: !business.isBrand || !!branchId,\n      brandId: business.brandId,\n      branchId: branchId || business.branchId!,\n    },\n    {\n      skip: !business.isValid,\n      fetchPolicy: 'cache-first',\n      context: { noBatch: true },\n    },\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport { GoogleMap, useLoadScript } from '@react-google-maps/api'\nimport { Sentry } from '@speedlo/sentry'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../app/useRoot'\nimport { appConfig } from '../config'\nimport { TMapModel } from '../models/MapModel'\nimport Pacman from './Pacman'\n\ninterface IBaseMapProps {\n  model: TMapModel\n  children?: ReactNode | ReactNode[] | (() => ReactNode | ReactNode[])\n  isMobile?: boolean\n}\n\n/* global google */\n\nconst getMapOptions = (isMobile: boolean): google.maps.MapOptions => {\n  return {\n    streetViewControl: false,\n    mapTypeControl: false,\n    fullscreenControl: false,\n    clickableIcons: false,\n    draggableCursor: 'default',\n    minZoom: 10,\n    zoomControlOptions: {\n      position: isMobile\n        ? google.maps.ControlPosition.RIGHT_CENTER\n        : google.maps.ControlPosition.RIGHT_TOP,\n    },\n  }\n}\n\nconst libraries = ['places']\n\nexport const BaseMap = observer<IBaseMapProps>(\n  ({ model, isMobile = false, children }) => {\n    const { user } = useRoot()\n\n    const { isLoaded, loadError, url: googleMapUrl } = useLoadScript({\n      id: 'script-loader',\n      version: 'weekly',\n      googleMapsApiKey: appConfig.googleMapsApi!,\n      libraries,\n      language: user.language,\n    })\n\n    const renderMap = () => {\n      return (\n        <GoogleMap\n          zoom={model.zoom}\n          center={model.center}\n          onCenterChanged={model.updatePosition}\n          onZoomChanged={model.updateZoom}\n          onClick={model.onClick}\n          onLoad={model.setMapRef}\n          onUnmount={() => model.setMapRef(null)}\n          options={getMapOptions(isMobile)}\n          mapContainerStyle={{\n            borderRadius: '0 0 0.5rem 0.5rem',\n            overflow: 'hidden',\n            height: isMobile ? '100%' : 'calc(100% - 3.75rem)',\n          }}\n        >\n          {typeof children === 'function' ? children() : children}\n        </GoogleMap>\n      )\n    }\n\n    const googleAvailable = Reflect.has(window, 'google')\n\n    if (loadError || (isLoaded && !googleAvailable)) {\n      if (loadError) {\n        Sentry.withScope(scope => {\n          scope.setExtras({ googleMapUrl })\n          Sentry.captureException(loadError)\n        })\n      }\n      return (\n        <h2>\n          <Trans>Cannot load map right now. Please try again later.</Trans>\n        </h2>\n      )\n    }\n\n    return isLoaded ? renderMap() : <Pacman noMargin={true} />\n  },\n)\n","import { useReaction } from '@speedlo/hooks'\n\nimport { useRoot } from '../../../app/useRoot'\nimport { useQFoodMenu } from '../../../graph/generated'\n\nexport function useFoodMenuQuery(branchId: MaybeID) {\n  const { user } = useRoot()\n  const result = useQFoodMenu(\n    { branchId: branchId! },\n    { skip: !branchId, fetchPolicy: 'cache-first' },\n  )\n\n  useReaction(\n    () => user.language,\n    () => {\n      result.refetch()\n    },\n  )\n\n  return result\n}\n","import { isoDate } from '@speedlo/graphql'\nimport { useRouterContext } from '@speedlo/hooks'\nimport { Sentry } from '@speedlo/sentry'\nimport { createObjectValidation, useXForm, XFormProvider } from '@speedlo/xform'\nimport React from 'react'\nimport { Form } from 'reactstrap'\n\nimport { hiddenError } from '../../forms/FormTextInput'\nimport {\n  MSubmitOrderVariables,\n  PaymentGateEnum,\n  QOrderFormAgreementsAgreements,\n  useMSubmitOrder,\n} from '../../graph/generated'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { i18n } from '../../i18n'\nimport { TOrderModel } from '../../models/OrderModel'\nimport { useOrderFormCheck } from './hooks/useOrderFormCheck'\nimport { useOrderPayment } from './hooks/useOrderPayment'\n\nexport type TAgreement = QOrderFormAgreementsAgreements\n\nexport type OrderFormValues = ReturnType<typeof getInitialValues>\n\nexport const NOTE_MAX_LENGTH = 50\n\nexport const OrderFormSetup: React.FC = ({ children }) => {\n  const orderModel = useOrderModel()\n  const { history } = useRouterContext()\n\n  const { executeGoPayPayment, paymentErrorModal } = useOrderPayment()\n\n  const [submitOrder] = useMSubmitOrder()\n\n  const validationSchema = React.useMemo(\n    () =>\n      createObjectValidation(Yup => ({\n        firstname: Yup.string().required(hiddenError),\n        lastname: Yup.string().required(hiddenError),\n        phonePrefix: Yup.string().required(hiddenError),\n        phone: Yup.string()\n          .required(hiddenError)\n          .matches(/\\d+/, i18n.t`Only numbers allowed for phone`),\n        email: Yup.string()\n          .required(hiddenError)\n          .email(i18n.t`Invalid email format`),\n        note: Yup.string()\n          .notRequired()\n          .max(\n            NOTE_MAX_LENGTH,\n            ({ value }) =>\n              i18n.t`Maximum length is ${i18n.plural({\n                value: NOTE_MAX_LENGTH,\n                other: '# characters',\n              })}. Typed ${i18n.plural({\n                value: value.length,\n                one: '# character',\n                other: '# characters',\n              })}`,\n          ),\n      })),\n    [],\n  )\n\n  const { isOrderInCart } = useOrderFormCheck()\n\n  React.useEffect(() => {\n    if (orderModel.hasOrder && !isOrderInCart) {\n      history.replace('/')\n    }\n  })\n\n  const onSubmit = React.useCallback(\n    async (values: OrderFormValues) => {\n      orderModel.submitStarted()\n\n      const variables = getSubmitVariables(values, orderModel)\n      const result = await submitOrder(variables)\n\n      if (!result) {\n        orderModel.submitFailed()\n        return\n      }\n\n      const { userErrors, gopayUrl } = result.submitOrder\n      if (userErrors.length) {\n        orderModel.submitFailed(userErrors)\n        return\n      }\n\n      if (orderModel.paymentMethod === PaymentGateEnum.Cash) {\n        orderModel.submitFinished()\n        history.replace(`/finish`)\n        return\n      }\n\n      if (orderModel.paymentMethod === PaymentGateEnum.Gopay) {\n        if (gopayUrl) {\n          executeGoPayPayment(gopayUrl).finally(() => {\n            orderModel.submitFinished()\n          })\n        } else {\n          Sentry.withScope(scope => {\n            scope.setExtras({ variables })\n            Sentry.captureMessage('No gopayUrl received for GoPay payment')\n          })\n          orderModel.submitFailed()\n        }\n      } else {\n        Sentry.withScope(scope => {\n          scope.setExtras({ variables })\n          Sentry.captureMessage(\n            `Unknown payment mode ${orderModel.paymentMethod}`,\n          )\n        })\n        orderModel.submitFailed()\n      }\n    },\n    [executeGoPayPayment, history, orderModel, submitOrder],\n  )\n\n  const xform = useXForm({\n    initialValues: getInitialValues(),\n    validationSchema,\n    onSubmit,\n    onFormChanges: console.log,\n  })\n\n  React.useEffect(() => {\n    orderModel.root.cart.setOrderSubmitting(xform.state.isSubmitting)\n  }, [xform.state, orderModel.root.cart])\n\n  return (\n    <>\n      {paymentErrorModal}\n      <XFormProvider value={xform}>\n        <Form onSubmit={xform.handlers.handleSubmit}>{children}</Form>\n      </XFormProvider>\n    </>\n  )\n}\n\nfunction getInitialValues() {\n  return {\n    firstname: '',\n    lastname: '',\n    email: '',\n    phone: '',\n    phonePrefix: '',\n    note: '',\n    agreements: [] as RoA<ID>,\n  }\n}\n\nfunction getSubmitVariables(\n  values: OrderFormValues,\n  orderModel: TOrderModel,\n): MSubmitOrderVariables {\n  return {\n    orderId: orderModel.orderId!,\n    customer: {\n      firstName: values.firstname,\n      lastName: values.lastname,\n      emails: [{ email: values.email }],\n      phones: [{ phone: `${values.phonePrefix}${values.phone}` }],\n    },\n    note: values.note,\n    tips: orderModel.tips,\n    paymentGate: orderModel.paymentMethod as PaymentGateEnum,\n    deliverAt: orderModel.deliverAt && isoDate(orderModel.deliverAt),\n    agreements: values.agreements,\n  }\n}\n","import React from 'react'\nimport { ButtonProps } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { PickerButton } from '../../common/PickerButton'\nimport { formatTime } from '../../helpers/formats'\n\ninterface IProps extends ButtonProps {\n  time: Date\n  isSelected: boolean\n  canBeSelected: boolean\n}\n\nconst Time = styled.div`\n  font-size: 1.2rem;\n`\n\nexport const TimePickerButton: React.FC<IProps> = ({\n  time,\n  ...buttonProps\n}) => (\n  <PickerButton\n    size=\"xs\"\n    outline={true}\n    width=\"10rem\"\n    data-testid={`timePickerButton__${time.getTime()}`}\n    {...buttonProps}\n  >\n    <Time>{formatTime(time)}</Time>\n  </PickerButton>\n)\n","import { DateFormat } from '@lingui/macro'\nimport { useNow } from '@speedlo/hooks'\nimport { DF, RM } from '@speedlo/tools'\nimport { isAfter, startOfDay } from 'date-fns/esm/fp'\nimport React, { Fragment } from 'react'\nimport styled from 'styled-components/macro'\n\nimport { TimePickerButton } from './TimePickerButton'\n\ninterface IProps {\n  steps: RoA<Date>\n  initialTime?: Maybe<Date>\n  onStepChange(step: Date): void\n}\n\nconst TimePickerContainer = styled.div`\n  margin-top: 1rem;\n`\n\nconst TimePickerDay = styled.div`\n  font-size: 1rem;\n  font-weight: bold;\n  text-align: left;\n  margin: 0 0 0.2rem 0.2rem;\n`\n\nexport const TimePicker: React.FC<IProps> = ({\n  steps: rawSteps,\n  initialTime,\n  onStepChange,\n}) => {\n  const getNow = useNow()\n\n  const steps = React.useMemo(() => {\n    const filtered = rawSteps.filter(isAfter(getNow()))\n    return RM.sort(RM.ascend(RM.invoker(0, 'getTime')), filtered)\n  }, [getNow, rawSteps])\n\n  const days = React.useMemo(() => {\n    return RM.uniq(RM.map(startOfDay, steps)) as Date[]\n  }, [steps])\n\n  const [stepIdx, setStepIdx] = React.useState(0)\n\n  React.useEffect(() => {\n    if (initialTime) {\n      setStepIdx(DF.closestIndexTo(initialTime, steps))\n    }\n  }, [initialTime, steps])\n\n  return (\n    <TimePickerContainer>\n      {days.map(day => (\n        <Fragment key={day.getDate()}>\n          <TimePickerDay>\n            <DateFormat\n              value={day}\n              format={{ month: 'long', day: 'numeric', weekday: 'long' }}\n            />\n          </TimePickerDay>\n          {steps.map((step, idx) =>\n            DF.isEqual(day, DF.startOfDay(step)) ? (\n              <TimePickerButton\n                key={step.getTime()}\n                time={step}\n                isSelected={idx === stepIdx}\n                canBeSelected={true}\n                onClick={() => {\n                  setStepIdx(idx)\n                  onStepChange(step)\n                }}\n              />\n            ) : null,\n          )}\n        </Fragment>\n      ))}\n    </TimePickerContainer>\n  )\n}\n","import '../../common/Modal.css'\n\nimport { Trans } from '@lingui/macro'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport { Container, Modal, ModalBody, ModalHeader } from 'reactstrap'\n\nimport { useRoot } from '../../app/useRoot'\nimport { PrimaryButton } from '../../common/Buttons'\nimport { useDelayedOrder } from '../../hooks/useDelayedOrder'\nimport { i18n } from '../../i18n'\nimport { TimePicker } from '../timePicker/TimePicker'\n\nexport const OrderTimePicker = observer(() => {\n  const { order } = useRoot()\n\n  const { getSteps, canBeDelayed, changeDeliveryTime } = useDelayedOrder()\n\n  const selectedTime = React.useRef<Maybe<Date>>(order.deliverAt)\n  const onStepChange = React.useCallback((step: Date) => {\n    selectedTime.current = step\n  }, [])\n\n  const onConfirmAndClose = () => {\n    const time = selectedTime.current\n    changeDeliveryTime(time)\n    order.closeTimePicker()\n  }\n\n  const renderModalContent = () => {\n    if (!canBeDelayed()) {\n      return (\n        <Trans>\n          It's not possible to pick a specific order time at this moment.\n        </Trans>\n      )\n    }\n\n    return (\n      <TimePicker\n        steps={getSteps()!}\n        initialTime={order.deliverAt}\n        onStepChange={onStepChange}\n      />\n    )\n  }\n\n  const renderBottomLine = () => {\n    if (!canBeDelayed()) {\n      return null\n    }\n    return (\n      <>\n        <div className=\"modal__body__button__strip\" />\n        <PrimaryButton\n          size=\"md\"\n          onClick={onConfirmAndClose}\n          className=\"modal__body__button\"\n        >\n          <Trans>Confirm time</Trans>\n        </PrimaryButton>\n      </>\n    )\n  }\n\n  const header = order.usingDeliveryOrderMethod\n    ? i18n.t`Deliver at what time?`\n    : i18n.t`When you will pickup the order?`\n\n  return (\n    <Modal\n      isOpen={order.timePickerOpen}\n      toggle={order.closeTimePicker}\n      className=\"modal__container\"\n      autoFocus={true}\n      backdrop=\"static\"\n      fade={false}\n    >\n      <ModalHeader\n        toggle={order.closeTimePicker}\n        tag={Container}\n        className=\"modal__header\"\n      >\n        <span>{header}</span>\n      </ModalHeader>\n      <ModalBody className=\"modal__body\">\n        <div className=\"modal__body__content\">{renderModalContent()}</div>\n        <div className=\"modal__body__button__line\">{renderBottomLine()}</div>\n      </ModalBody>\n    </Modal>\n  )\n})\n","import { isoDate } from '@speedlo/graphql'\nimport { RM } from '@speedlo/tools'\nimport {\n  addMinutes,\n  endOfMinute,\n  getMinutes,\n  startOfMinute,\n  subMinutes,\n  toDate,\n} from 'date-fns'\nimport React from 'react'\n\nimport { useRoot } from '../app/useRoot'\nimport {\n  QDelayedOrderDelayedOrder,\n  QDelayedOrderIntervals,\n  useMOrderDeliveryTime,\n  useQDelayedOrder,\n} from '../graph/generated'\nimport { useLoadingCache } from './useLoadingCache'\n\nconst STEP_SIZE_MINUTES = 15\n\nexport function useDelayedOrder() {\n  const { order, cart } = useRoot()\n\n  const skip = !order.branchId\n\n  const getData = useLoadingCache<Maybe<QDelayedOrderDelayedOrder>>(skip)\n\n  const { data, loading } = useQDelayedOrder(\n    { branchId: order.branchId! },\n    { skip },\n  )\n\n  const cachedData = getData(loading, () => {\n    return skip ? null : data.delayedOrder\n  })\n\n  const getSteps = React.useCallback(() => {\n    if (cachedData === null) {\n      return null\n    }\n    return createSteps(cachedData.intervals)\n  }, [cachedData])\n\n  const canBeDelayed = React.useCallback(() => {\n    return cachedData !== null && cachedData.intervals.length > 0\n  }, [cachedData])\n\n  const [updateOrder] = useMOrderDeliveryTime()\n\n  const changeDeliveryTime = React.useCallback(\n    (deliverAt: Maybe<Date>) => {\n      updateOrder({\n        orderId: order.orderId!,\n        deliverAt: deliverAt && isoDate(deliverAt),\n        withGoods: cart.withGoods,\n      })\n      order.setDeliverAt(deliverAt)\n    },\n    [cart, order, updateOrder],\n  )\n\n  return {\n    getSteps,\n    canBeDelayed,\n    isEnabled: Boolean(cachedData) && cachedData!.enabled,\n    changeDeliveryTime,\n  }\n}\n\nfunction createSteps(intervals: RoA<QDelayedOrderIntervals>) {\n  return RM.flatten(intervals.map(createTimeSteps))\n}\n\nfunction createTimeSteps({ start, end }: QDelayedOrderIntervals) {\n  let current = startOfMinute(timeClampUp(toDate(start), STEP_SIZE_MINUTES))\n  const steps: Date[] = []\n  const endMinute = endOfMinute(subMinutes(toDate(end), 1))\n  do {\n    steps.push(current)\n    current = addMinutes(current, STEP_SIZE_MINUTES)\n  } while (current <= endMinute)\n  return steps\n}\n\nfunction timeClampUp(time: Date, minuteStep: number) {\n  return addMinutes(timeClampDown(time, minuteStep), minuteStep)\n}\n\nfunction timeClampDown(time: Date, minuteStep: number) {\n  return subMinutes(time, getMinutes(time) % minuteStep)\n}\n","import React from 'react'\n\nexport function useLoadingCache<TValue>(shouldSkip: boolean = false) {\n  const cached = React.useRef<TValue | null>(null)\n\n  // clear cache when skipping\n  React.useEffect(() => {\n    if (shouldSkip) {\n      cached.current = null\n    }\n  }, [shouldSkip])\n\n  const buildValue = React.useCallback(\n    (loading: boolean, getNext: () => TValue) => {\n      if (loading && !shouldSkip) {\n        return cached.current\n      } else {\n        const next = getNext()\n        cached.current = next\n        return next\n      }\n    },\n    [shouldSkip],\n  )\n\n  return buildValue\n}\n","import { LanguagePicker as LangPick } from '@speedlo/ui'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../app/useRoot'\n\ninterface IProps {\n  className?: string\n}\n\nexport const LanguagePicker = observer<IProps>(({ className }) => {\n  const { business, user } = useRoot()\n  if (!business.isValid) {\n    return null\n  }\n  return (\n    <LangPick\n      availableLanguages={business.branch!.supportedLanguages}\n      selectedLanguage={user.language}\n      onChange={language => {\n        if (language !== user.language) {\n          user.selectLanguage(language)\n          // TODO: Figure out way to flush model persistence\n          setTimeout(() => {\n            window.location.reload()\n          }, 300)\n        }\n      }}\n      className={className}\n      backgroundColor=\"white\"\n      arrowColor=\"#5A5A5A\"\n    />\n  )\n})\n","import { Plural, Trans } from '@lingui/react'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../app/useRoot'\nimport { AlertModal } from '../../common/AlertModal'\nimport { PrimaryButton } from '../../common/Buttons'\nimport { FCompanyBranchStatusFragment } from '../../graph/generated'\nimport { useDelayedOrder } from '../../hooks/useDelayedOrder'\nimport { useShopStatus } from '../../hooks/useShopStatus'\nimport { i18n } from '../../i18n'\n\ninterface IProps {\n  status: FCompanyBranchStatusFragment\n}\n\nexport const ShopClosingTimeModal = observer<IProps>(({ status }) => {\n  const { user, order } = useRoot()\n  const { decision, openingIn, closedNote } = useShopStatus({\n    status,\n    // Do not want update here as it would be showing modal every time :)\n    updateInterval: 0,\n  })\n\n  const { canBeDelayed, isEnabled } = useDelayedOrder()\n\n  if (order.isDelayed) {\n    // don't show modal if user has previous chosen time of delivery\n    return null\n  }\n\n  return (\n    <AlertModal\n      isOpen={\n        (decision === 'Closed' || decision === 'OpeningSoon') &&\n        !user.closingTimeAlertHidden\n      }\n      onClose={user.hideClosingTime}\n      headerText={i18n.t`We are closed right now`}\n    >\n      <p>\n        {closedNote ||\n          i18n.t`We're sorry, but we do not accept new orders at this time.`}\n      </p>\n      {decision === 'OpeningSoon' && (\n        <p>\n          <Trans>\n            You can prepare your order because we are{' '}\n            <Plural\n              value={openingIn}\n              one=\"opening in 1 minute\"\n              other=\"opening in # minutes\"\n            />\n            !\n          </Trans>\n        </p>\n      )}\n      {isEnabled && canBeDelayed() && (\n        <PrimaryButton\n          onClick={() => {\n            user.hideClosingTime()\n            order.openTimePicker()\n          }}\n        >\n          <Trans>Select preorder time</Trans>\n        </PrimaryButton>\n      )}\n    </AlertModal>\n  )\n})\n","import './ShopHeaderIcons.css'\n\nimport { getLogo } from '@speedlo/assets'\nimport React from 'react'\n\nexport const ShopHeaderIcons = () => (\n  <>\n    <img\n      src={getLogo('doveze')}\n      className=\"shop__header__icons__doveze\"\n      data-testid=\"ShopHeaderIcons__AppLogo\"\n      alt=\"logo Doveze.cz\"\n    />\n    <img\n      src={getLogo('mastercard')}\n      className=\"shop__header__icons__commerce\"\n      alt=\"MasterCard\"\n    />\n    <img\n      src={getLogo('visa')}\n      className=\"shop__header__icons__commerce\"\n      data-testid=\"ShopHeaderIcons__VisaLogo\"\n      alt=\"VISA\"\n    />\n    <img\n      src={getLogo('gopay')}\n      className=\"shop__header__icons__gopay\"\n      alt=\"GoPay\"\n      data-testid=\"ShopHeaderIcons__GoPayLogo\"\n    />\n  </>\n)\n","import { DateFormat, Plural, Trans } from '@lingui/react'\nimport { isSameDay } from 'date-fns'\nimport React from 'react'\nimport { Route } from 'react-router-dom'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { FCompanyBranchStatusFragment } from '../../graph/generated'\nimport { useShopStatus } from '../../hooks/useShopStatus'\n\ninterface IProps {\n  status: FCompanyBranchStatusFragment\n  deliveryTime: number\n  pickupTime: number\n}\n\nexport const StyledStatusDisplayOpen = styled.span`\n  font-style: italic;\n  color: #0f9849;\n`\n\nexport const StyledStatusDisplayClosed = styled.span`\n  font-style: italic;\n  color: #b40000;\n`\n\nexport const ShopStatusDisplay: React.FC<IProps> = ({\n  status,\n  deliveryTime,\n  pickupTime,\n}) => {\n  const { order } = useRoot()\n  const { decision, openingIn, closingIn } = useShopStatus({\n    status,\n  })\n\n  if (!status) {\n    return null\n  }\n\n  if (status.isOpen === false) {\n    if (!status.willOpenAt) {\n      return (\n        <StyledStatusDisplayClosed>\n          <Trans>We are closed until further notice</Trans>\n        </StyledStatusDisplayClosed>\n      )\n    }\n    const closestBH = status.businessHours[0]\n    if (closestBH && closestBH.closedNote) {\n      return (\n        <StyledStatusDisplayClosed>\n          {closestBH.closedNote}\n        </StyledStatusDisplayClosed>\n      )\n    }\n  }\n\n  switch (decision) {\n    case 'Open':\n      let timingDisplay\n      if (order.usingDeliveryOrderMethod && status.defaultDeliveryTimeEnabled) {\n        timingDisplay = (\n          <Trans>We are delivering in {deliveryTime} minutes</Trans>\n        )\n      }\n      if (order.usingPickupOrderMethod && status.defaultPickupTimeEnabled) {\n        timingDisplay = (\n          <Trans>We can prepare your order in {pickupTime} minutes</Trans>\n        )\n      }\n      return (\n        <Route\n          path=\"/order\"\n          render={() => (\n            <StyledStatusDisplayOpen data-testid=\"statusDisplayOpen\">\n              {timingDisplay}\n            </StyledStatusDisplayOpen>\n          )}\n        />\n      )\n    case 'OpeningSoon':\n      return (\n        <StyledStatusDisplayClosed>\n          <Plural\n            value={openingIn}\n            one=\"Opening in 1 minute\"\n            other=\"Opening in # minutes\"\n          />\n        </StyledStatusDisplayClosed>\n      )\n    case 'ClosingSoon':\n      return (\n        <StyledStatusDisplayOpen>\n          <Plural\n            value={closingIn}\n            one=\"Closing in 1 minute\"\n            other=\"Closing in # minutes\"\n          />\n        </StyledStatusDisplayOpen>\n      )\n    case 'Closed':\n      return (\n        <StyledStatusDisplayClosed>\n          {status.willOpenAt ? (\n            <Trans>We will open at {formatOpenTime(status.willOpenAt)}</Trans>\n          ) : (\n            <Trans>Closed</Trans>\n          )}\n        </StyledStatusDisplayClosed>\n      )\n  }\n}\n\nexport function formatOpenTime(openAt: string) {\n  const openAtDate = new Date(openAt)\n  const nowDate = new Date()\n  let format: Intl.DateTimeFormatOptions = {\n    hour: 'numeric',\n    minute: 'numeric',\n  }\n  if (!isSameDay(openAtDate, nowDate)) {\n    format = {\n      ...format,\n      weekday: 'long',\n    }\n  }\n  return <DateFormat value={openAtDate} format={format} />\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport { Link } from 'react-router-dom'\nimport { Button } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { PrimaryButton } from '../../common/Buttons'\nimport { Desktop, Mobile } from '../../common/Responsive'\nimport { QOrderFinishQuery } from '../../graph/generated'\n\ninterface IProps {\n  finish: QOrderFinishQuery\n}\nconst CenteredButtonContainer = styled.div`\n  text-align: center;\n`\n\nexport const FinishViewFooter: React.FC<IProps> = ({\n  finish: { androidApp, iosApp },\n}) => {\n  const renderHomeButton = () => (\n    <Link to=\"/\">\n      <PrimaryButton className=\"finish__view__submit__line__button\">\n        <Trans>Back to home page</Trans>\n      </PrimaryButton>\n    </Link>\n  )\n  return (\n    <>\n      <Desktop>\n        {(androidApp || iosApp) && (\n          <div className=\"finish__view__apps__propagation\">\n            <div className=\"finish__view__apps__propagation__header\">\n              <Trans>What about mobile app?</Trans>\n            </div>\n            <div className=\"finish__view__apps__propagation__description\">\n              <Trans>\n                We have prepared mobile app, so you could order from anywhere!\n              </Trans>\n            </div>\n\n            {androidApp && (\n              <a href={androidApp.url}>\n                <Button\n                  className=\"finish__view__apps__propagation__button\"\n                  color=\"secondary\"\n                >\n                  Google Play\n                </Button>\n              </a>\n            )}\n\n            {iosApp && (\n              <a href={iosApp.url}>\n                <Button\n                  className=\"finish__view__apps__propagation__button\"\n                  color=\"secondary\"\n                >\n                  App Store\n                </Button>\n              </a>\n            )}\n          </div>\n        )}\n        <CenteredButtonContainer>{renderHomeButton()}</CenteredButtonContainer>\n      </Desktop>\n\n      <Mobile>\n        <div\n          className=\"finish__view__submit__line\"\n          style={{ textAlign: 'center' }}\n        >\n          <div className=\"finish__view__submit__line__strip\" />\n          {renderHomeButton()}\n        </div>\n      </Mobile>\n    </>\n  )\n}\n","import React from 'react'\n\nimport { useRoot } from '../../app/useRoot'\nimport Pacman from '../../common/Pacman'\nimport { QOrderFinishQuery, useQOrderFinish } from '../../graph/generated'\nimport { useEmptyOrderRedirect } from '../../hooks/useEmptyOrderRedirect'\n\ninterface IProps {\n  render(result: QOrderFinishQuery): ReactNode\n}\n\nexport const FinishViewLoader: React.FC<IProps> = ({ render }) => {\n  const { order } = useRoot()\n  useEmptyOrderRedirect()\n\n  const { data, loading } = useQOrderFinish({\n    branchId: order.branchId!,\n    orderId: order.orderId!,\n  })\n\n  if (loading) {\n    return <Pacman />\n  }\n\n  return render(data)\n}\n","import { Trans } from '@lingui/macro'\nimport { RM } from '@speedlo/tools'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport {\n  FOrderFinishedFragment,\n  FOrderFinishedItems,\n  FOrderFinishedOrderPayments,\n  PaymentTypeEnum,\n} from '../../graph/generated'\nimport { i18n } from '../../i18n'\n\ninterface IProps {\n  order: FOrderFinishedFragment\n}\n\nconst HeaderThemed = styled.div`\n  background-color: ${({ theme }) => theme.primary};\n`\n\nconst PriceThemed = styled.div`\n  background-color: ${({ theme }) => theme.primary};\n`\n\nconst PriceCornerThemed = styled.div`\n  border-top-color: ${({ theme }) => theme.primary} !important;\n`\n\nexport const FinishViewOrder: React.FC<IProps> = ({ order }) => (\n  <>\n    <HeaderThemed className=\"finish__view__header\">\n      <div className=\"finish__view__header__inner\">\n        <span className=\"flaticon-transport-1 finish__view__header__icon\" />\n        <h3>\n          <Trans>It's done! Thank you :-)</Trans>\n        </h3>\n      </div>\n    </HeaderThemed>\n    <h4>\n      <Trans>Your order was successfully accepted!</Trans>{' '}\n      {getPaymentInfo(order)}\n    </h4>\n    <div className=\"finish__view__items\">\n      <div className=\"finish__view__items__look__to\">\n        <Trans>You can look forward to:</Trans>\n      </div>\n      {order.items.map(item => (\n        <OrderItem key={item.id} {...item} />\n      ))}\n      <PriceCornerThemed className=\"finish__view__items__price__corner\" />\n      <PriceThemed className=\"finish__view__items__price\">\n        {getPaymentPrice(order)} <b>{order.totalSum.formattedValue}</b>\n      </PriceThemed>\n    </div>\n  </>\n)\n\nconst hasMethod = (paymentType: PaymentTypeEnum) => (\n  payment: FOrderFinishedOrderPayments,\n) => payment.paymentMethod.paymentType.enum === paymentType\n\nfunction getPaymentInfo({ orderPayments }: FOrderFinishedFragment) {\n  if (orderPayments.some(hasMethod(PaymentTypeEnum.Cash))) {\n    return i18n.t`You will pay at pickup.`\n  }\n  if (orderPayments.some(hasMethod(PaymentTypeEnum.Credit))) {\n    return i18n.t`You have payed.`\n  }\n  return null\n}\n\nfunction getPaymentPrice({ orderPayments, totalSum }: FOrderFinishedFragment) {\n  if (orderPayments.some(hasMethod(PaymentTypeEnum.Cash))) {\n    return i18n.t`Total cost to be payed:`\n  }\n  if (orderPayments.some(hasMethod(PaymentTypeEnum.Credit))) {\n    return i18n.t`Total cost payed:`\n  }\n  return null\n}\n\nfunction OrderItem({ recipe, sideDishes }: FOrderFinishedItems) {\n  return (\n    <div>\n      <b>{recipe.nameLabel}</b>\n      {sideDishes.length\n        ? ` + ${sideDishes.map(RM.path(['recipe', 'nameLabel'])).join(',')}`\n        : null}\n    </div>\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { QOrderFinishCompanyBranch } from '../../graph/generated'\n\ninterface IProps {\n  branch: QOrderFinishCompanyBranch\n}\n\nconst PhoneNumberLinkStyled = styled.a`\n  color: inherit;\n  text-decoration: none;\n  &:hover {\n    text-decoration: underline;\n  }\n`\n\nexport const FinishViewSupport: React.FC<IProps> = ({ branch }) => (\n  <div className=\"finish__view__support\">\n    <h4>\n      <Trans>Any question? Do you have a problem? Call:</Trans>\n    </h4>\n    <span className=\"flaticon-technology finish__view__support__icon\" />\n    <span className=\"finish__view__support__phone\">\n      <PhoneNumberLinkStyled href={`tel:${branch.phone}`}>\n        {branch.phone}\n      </PhoneNumberLinkStyled>\n    </span>\n  </div>\n)\n","import './ButtonStripe.css'\n\nimport React from 'react'\n\nconst ButtonStripe: React.FC = ({ children }) => (\n  <div className=\"button__stripe\">\n    <div className=\"button__stripe__bar\" />\n    <div className=\"button__stripe__button\">{children}</div>\n  </div>\n)\n\nexport default ButtonStripe\n","import { useGoogleMap } from '@react-google-maps/api'\nimport React from 'react'\n\nimport { useRoot } from '../../../app/useRoot'\nimport { GeoPoint, gpsToLatLngLit } from '../../../helpers/gps'\n\nexport function useMapPanning() {\n  const { map } = useRoot()\n  const mapRef = useGoogleMap()\n\n  const prevGps = React.useRef<Maybe<GeoPoint>>(null)\n\n  const panToGps = (gps: GeoPoint) => {\n    if (!mapRef) {\n      map.log('cannot pan map as ref is not available')\n      return\n    }\n    const latLng = gpsToLatLngLit(gps)\n    map.log('panning to %j', latLng)\n    mapRef.panTo(latLng)\n    prevGps.current = gps\n  }\n\n  return (gps: GeoPoint) => {\n    const prev = prevGps.current\n    if (\n      !prev ||\n      (prev.latitude !== gps.latitude && prev.longitude !== gps.longitude)\n    ) {\n      panToGps(gps)\n    }\n  }\n}\n","import { OverlayView } from '@react-google-maps/api'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { FPickupBranchFragment } from '../graph/generated'\nimport { gpsToLatLng } from '../helpers/gps'\n\ninterface IProps {\n  branch: FPickupBranchFragment\n  onClick?: () => void\n}\n\nconst StyledPickupMapMarker = styled.div`\n  cursor: pointer;\n  color: white;\n  opacity: 0.5;\n\n  &::before {\n    font-size: 1.3rem;\n    margin: 0;\n    padding: 0.5rem;\n    background-color: #ff0000;\n    border-radius: 1rem;\n  }\n`\n\nexport const MapBranchMarker: React.FC<IProps> = ({ branch, onClick }) => {\n  return (\n    <OverlayView\n      position={gpsToLatLng(branch.gps)}\n      mapPaneName={OverlayView.OVERLAY_MOUSE_TARGET}\n      getPixelPositionOffset={(width, height) => ({\n        x: width === 0 ? -12 : -(width / 2),\n        y: height === 0 ? -12 : -(height / 2),\n      })}\n    >\n      <StyledPickupMapMarker\n        className=\"flaticon-restaurant\"\n        data-testid=\"PickupMapMarker\"\n        title={branch.name}\n        onClick={onClick}\n      />\n    </OverlayView>\n  )\n}\n","import { useApolloClient } from '@speedlo/graphql'\n\nimport { useRoot } from '../app/useRoot'\nimport {\n  FCartGoodsItems,\n  FCartPresencePresence,\n  FRecipeFragment,\n  FRecipeFragmentDoc,\n  MAddToCartMutation,\n  MAddToCartVariables,\n  QCartDocument,\n  QCartQuery,\n  QCartVariables,\n  useMAddToCart,\n} from '../graph/generated'\n\nlet counter = 1\n\nconst NO_SIDEDISHES = []\n\nexport function useAddToCart() {\n  const { order, cart: cartModel } = useRoot()\n  const client = useApolloClient()\n\n  const [addToCart] = useMAddToCart({\n    context: { noBatch: true },\n  })\n\n  const executeAddToCart = (\n    recipeId: ID,\n    sideDishes: RoA<ID> = NO_SIDEDISHES,\n  ) => {\n    const variables: MAddToCartVariables = {\n      orderId: order.orderId!,\n      recipeId,\n      sideDishes,\n      withGoods: cartModel.withGoods,\n      withPresence: cartModel.withPresence,\n    }\n    return addToCart(variables, {\n      optimisticResponse: makeOptimisticResponse(variables),\n    })\n  }\n\n  return executeAddToCart\n\n  function makeOptimisticResponse(\n    variables: MAddToCartVariables,\n  ): MAddToCartMutation | undefined {\n    const current = client.readQuery<QCartQuery, QCartVariables>(\n      {\n        query: QCartDocument,\n        variables: {\n          orderId: variables.orderId,\n          withGoods: cartModel.withGoods,\n          withPresence: cartModel.withPresence,\n        },\n      },\n      true,\n    )\n    if (!current) {\n      return undefined\n    }\n    const id = `-${counter++}`\n    const addPresence = (): RoA<FCartPresencePresence> => {\n      if (!cartModel.withPresence) {\n        return current.order.presence\n      }\n      return [\n        ...current.order.presence,\n        {\n          __typename: 'OrderRecipe',\n          id,\n          recipe: {\n            __typename: 'Recipe',\n            id: variables.recipeId,\n          },\n        },\n      ]\n    }\n    const addItem = (): RoA<FCartGoodsItems> => {\n      if (!cartModel.withGoods) {\n        return current.order.items\n      }\n      const recipe = client.readFragment<FRecipeFragment>(\n        {\n          id: `Recipe-${variables.recipeId}`,\n          fragment: FRecipeFragmentDoc,\n          fragmentName: 'FRecipe',\n        },\n        true,\n      )\n      if (!recipe) {\n        return current.order.items\n      }\n      return [\n        ...current.order.items,\n        {\n          __typename: 'OrderRecipe',\n          automatic: false,\n          id,\n          price: {\n            __typename: 'PriceConverted',\n            formattedValue: '???',\n            value: -1,\n          },\n          recipe,\n          sideDishes: [],\n        },\n      ]\n    }\n    return {\n      __typename: 'Mutation',\n      add: {\n        ...current.order,\n        countWares: current.order.countWares + 1,\n        totalSum: {\n          ...current.order.totalSum,\n          value: -1,\n        },\n        items: addItem(),\n        presence: addPresence(),\n      },\n    }\n  }\n}\n","import React from 'react'\nimport { Button, ButtonProps } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\ninterface IProps extends ButtonProps {\n  isSelected: boolean\n  width: string\n}\n\nconst PickerButtonStyled = styled(({ isSelected, width, ...props }) => (\n  <Button {...props} />\n))`\n  border-radius: 0.6rem;\n  margin: 0.5rem;\n  background-color: ${props =>\n    props.isSelected ? props.theme.tertiary : 'transparent'} !important;\n  color: ${props =>\n    props.isSelected ? props.theme.tertiaryText : 'initial'} !important;\n  &:hover {\n    border-color: ${({ theme }) => theme.tertiaryHover} !important;\n  }\n  width: ${props => props.width};\n  @media (max-width: 370px) {\n    width: 100%;\n  }\n  &.btn-outline-secondary {\n    color: #2e2e2e;\n    border-color: #d4d4d4;\n  }\n  &.btn-outline-secondary.active {\n    color: white;\n  }\n`\n\nexport const PickerButton: React.FC<IProps> = ({\n  isSelected,\n  onSelect,\n  children,\n  ...buttonProps\n}) => {\n  return (\n    <PickerButtonStyled isSelected={isSelected} {...buttonProps}>\n      {children}\n    </PickerButtonStyled>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { mediaMobile } from './Responsive'\n\ninterface IProps {}\n\nconst StyledButtonStrip = styled.div`\n  margin: 0;\n  margin-bottom: 1rem;\n  text-align: center;\n  position: sticky;\n  bottom: 1rem;\n\n  ${mediaMobile`\n      position: fixed;\n      bottom: 0;\n      width: 100%;\n  `}\n\n  div.strip {\n    background-color: #d4d4d4;\n    position: relative;\n    top: 3.2rem;\n    z-index: 0;\n    height: 1.6rem;\n    width: 100%;\n  }\n  button {\n    margin: 1rem;\n    padding: 0.8rem 1.6rem;\n    z-index: 1;\n    position: relative;\n  }\n`\n\nexport const ButtonStrip: React.FC<IProps> = ({ children }) => {\n  return (\n    <StyledButtonStrip>\n      <div className=\"strip\" />\n      {children}\n    </StyledButtonStrip>\n  )\n}\n","import '../../common/Modal.css'\n\nimport { Trans } from '@lingui/macro'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport { Button, Container, Modal, ModalBody, ModalHeader } from 'reactstrap'\n\nimport { useRoot } from '../../app/useRoot'\n\nexport const OrderErrorModal: React.FC = () => {\n  const { order } = useRoot()\n  return useObserver(() => (\n    <Modal\n      isOpen={order.hasErrors}\n      toggle={order.clearErrors}\n      className=\"modal__container\"\n    >\n      <ModalHeader\n        toggle={order.clearErrors}\n        tag={Container}\n        className=\"modal__header\"\n      >\n        <span>\n          <Trans>Order can not be completed</Trans>\n        </span>\n      </ModalHeader>\n      <ModalBody className=\"modal__body\">\n        <div className=\"modal__body__content\">\n          {order.hasErrors &&\n            order.submitErrors!.map((error, idx) => (\n              <div key={idx}>{error}</div>\n            ))}\n        </div>\n        <div className=\"modal__body__button__line\">\n          <div className=\"modal__body__button__strip\" />\n          <Button\n            className=\"modal__body__button\"\n            color=\"primary\"\n            onClick={order.clearErrors}\n          >\n            <Trans>I understand</Trans>\n          </Button>\n          />\n        </div>\n      </ModalBody>\n    </Modal>\n  ))\n}\n","import { fakerCZ } from '@speedlo/testing/dist/faker'\nimport { useXFormCtx } from '@speedlo/xform'\nimport React from 'react'\n\nimport { SecondaryButton } from '../../common/Buttons'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { NOTE_MAX_LENGTH, OrderFormValues } from './OrderFormSetup'\n\nexport const OrderFormAutoFill: React.FC = () => {\n  const orderModel = useOrderModel()\n  const xform = useXFormCtx<OrderFormValues>()\n  if (process.env.REACT_APP_STAGE === 'prod') {\n    return null\n  }\n  return (\n    <SecondaryButton\n      style={{ marginBottom: '0.5rem' }}\n      onClick={() => {\n        const values = {\n          firstname: fakerCZ.name.firstName(),\n          lastname: fakerCZ.name.lastName(),\n          email: fakerCZ.internet.email(),\n          phone: fakerCZ.phone.phoneNumberFormat(0).replace(/\\s/g, ''),\n          phonePrefix: '+420',\n          note: fakerCZ.lorem.sentence().slice(0, NOTE_MAX_LENGTH - 1),\n          agreements: [],\n        }\n        Object.keys(values).forEach(key => {\n          xform.state.touched.add(key)\n        })\n        xform.api.mergeValues(values)\n        xform.api.validateForm()\n\n        if (orderModel.usingPaymentMethodWithTips) {\n          orderModel.setTips(15)\n        }\n      }}\n    >\n      Autofill form [DEV ONLY]\n    </SecondaryButton>\n  )\n}\n","import { OrderStateCategoryEnum, useQOrderForm } from '../../../graph/generated'\nimport { useOrderModel } from '../../../hooks/useOrderModel'\n\nexport function useOrderFormCheck() {\n  const orderModel = useOrderModel()\n\n  const { data, loading } = useQOrderForm(\n    { orderId: orderModel.orderId! },\n    { skip: !orderModel.orderId },\n  )\n\n  const isOrderInCart =\n    loading || data.order.orderStateCategory === OrderStateCategoryEnum.InCart\n  const hasItemsInCart = !loading && data.order.countWares > 0\n\n  return { isOrderInCart, hasItemsInCart }\n}\n","import { useRouterContext } from '@speedlo/hooks'\nimport { useGoPay } from '@speedlo/payments'\nimport React from 'react'\n\nimport { useRoot } from '../../../app/useRoot'\nimport { useExecutableQOrderPaymentStatus } from '../../../graph/generated'\nimport { useAlertModal } from '../../../hooks/useAlertModal'\nimport { i18n } from '../../../i18n'\n\nexport function useOrderPayment() {\n  const { order: orderModel, business } = useRoot()\n  const { history } = useRouterContext()\n\n  const [paymentErrorModal, alertPaymentError] = useAlertModal()\n\n  const [executePaymentStatusCheck] = useExecutableQOrderPaymentStatus({\n    fetchPolicy: 'no-cache',\n  })\n\n  const onFinish = React.useCallback(() => {\n    history.replace('/finish')\n  }, [history])\n\n  const onError = React.useCallback(\n    errors => {\n      const phone = business.branch!.phone\n      alertPaymentError(\n        i18n.t`Payment status check has failed`,\n        errors.length\n          ? errors.join('<br />')\n          : i18n.t`We were unable to verify status of your payment. Please contact operator using number ${phone}`,\n      )\n    },\n    [alertPaymentError, business],\n  )\n\n  const queryPaymentStatus = React.useCallback(\n    (orderId = orderModel.orderId!, userToken) => {\n      if (!orderId) {\n        return Promise.resolve(null)\n      }\n      orderModel.goPayStatusCheck(true)\n      return executePaymentStatusCheck(\n        { orderId },\n        {\n          fetchPolicy: 'no-cache',\n          context: {\n            invalidateWithToken: userToken,\n            noBatch: true,\n          },\n        },\n      )\n        .then(result => {\n          return result ? result.status : null\n        })\n        .finally(() => {\n          orderModel.goPayStatusCheck(false)\n          return null\n        })\n    },\n    [executePaymentStatusCheck, orderModel],\n  )\n\n  const { executeGoPayPayment, paymentLoading: paymentProcessing } = useGoPay(\n    queryPaymentStatus,\n    {\n      onError,\n      onFinish,\n    },\n  )\n\n  return { paymentErrorModal, executeGoPayPayment, paymentProcessing }\n}\n","import { useReaction } from '@speedlo/hooks'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport FormGroup from 'reactstrap/lib/FormGroup'\nimport Input from 'reactstrap/lib/Input'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { useMOrderTipUpdate } from '../../graph/generated'\nimport { i18n } from '../../i18n'\n\nconst StyledOrderFormTipInput = styled.div`\n  margin: 0.8rem 0 1.4rem 0;\n`\n\nexport const OrderFormTipInput = observer(() => {\n  const { order, cart } = useRoot()\n  const [updateTip] = useMOrderTipUpdate()\n\n  // TODO: Vyresit aby se nespoustelo po navratu z GoPay\n  useReaction(\n    () => (order.usingPaymentMethodWithTips ? Number(order.tips) : 0),\n    tips => {\n      updateTip({\n        tips,\n        orderId: order.orderId!,\n        withGoods: cart.withGoods,\n      })\n    },\n  )\n\n  if (!order.usingPaymentMethodWithTips) {\n    return null\n  }\n\n  return (\n    <StyledOrderFormTipInput>\n      <FormGroup>\n        <Input\n          type=\"select\"\n          value={order.tips}\n          onChange={ev => {\n            order.setTips(Number.parseInt(ev.target.value, 10))\n          }}\n          disabled={order.disableInteraction}\n          data-testid=\"orderTipsSelect\"\n        >\n          <option value={0}>{i18n.t`Without tips`}</option>\n          <option value={5}>{i18n.t`Tips 5%`}</option>\n          <option value={10}>{i18n.t`Tips 10%`}</option>\n          <option value={15}>{i18n.t`Tips 15%`}</option>\n          <option value={20}>{i18n.t`Tips 20%`}</option>\n          <option value={25}>{i18n.t`Tips 25%`}</option>\n        </Input>\n      </FormGroup>\n    </StyledOrderFormTipInput>\n  )\n})\n","import { Trans } from '@lingui/macro'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { AlertModal } from '../../common/AlertModal'\nimport Pacman from '../../common/Pacman'\n\nconst TextPadding = styled.div`\n  padding-bottom: 2rem;\n`\n\nexport const OrderGoPayModal: React.FC = () => {\n  const { order: orderModel } = useRoot()\n  return useObserver(() => (\n    <AlertModal isOpen={orderModel.isGoPayChecking} headerText=\"GoPay platba\">\n      <TextPadding>\n        <Trans>Checking your GoPay payment, please wait...</Trans>\n      </TextPadding>\n      <Pacman noMargin={true} />\n    </AlertModal>\n  ))\n}\n","import { useOrderPromoCodes } from '@speedlo/ui'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport { FormGroup, Input, InputGroup } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { SecondaryButton } from '../../common/Buttons'\nimport {\n  useMOrderPromoAdd,\n  useMOrderPromoRemove,\n  useQOrderPromoCodes,\n} from '../../graph/generated'\nimport { useAlertModal } from '../../hooks/useAlertModal'\nimport { i18n } from '../../i18n'\n\nconst CodesPanel = styled.div`\n  margin-top: 0.5rem;\n  & button {\n    margin-right: 0.5rem;\n    font-size: 0.7rem;\n  }\n`\n\nexport const OrderPromoInput = React.memo(() => {\n  const { order: orderModel, cart } = useRoot()\n  const [errorModal, showError] = useAlertModal()\n\n  const { data, loading } = useQOrderPromoCodes(\n    { orderId: orderModel.orderId! },\n    { skip: !orderModel.orderId },\n  )\n  const [addCodeMutation] = useMOrderPromoAdd()\n  const [removeCodeMutation] = useMOrderPromoRemove()\n\n  const onCodeAdd = React.useCallback(\n    async (code: string) => {\n      if (!orderModel.orderId) {\n        return\n      }\n      return addCodeMutation({\n        code,\n        orderId: orderModel.orderId,\n        withGoods: cart.withGoods,\n      })\n    },\n    [addCodeMutation, cart, orderModel],\n  )\n\n  const onCodeRemove = async (codeId: ID) => {\n    if (orderModel.orderId) {\n      removeCodeMutation({\n        codeId,\n        orderId: orderModel.orderId,\n        withGoods: cart.withGoods,\n      })\n    }\n  }\n\n  const onCodeErrors = (code, errors) => {\n    showError(\n      i18n.t`Promo code \"${code}\" is invalid`,\n      <div>\n        {errors.map(msg => (\n          <div key={msg}>{msg}</div>\n        ))}\n      </div>,\n    )\n  }\n\n  const { inputProps, inputRef } = useOrderPromoCodes({\n    onCodeAdd,\n    onCodeErrors,\n    getValidatingMessage: code => i18n.t`Validating promo code ${code}...`,\n  })\n\n  const codes = loading ? [] : data.order.promoCodes\n\n  return useObserver(() => (\n    <FormGroup>\n      {errorModal}\n      <InputGroup>\n        <Input\n          innerRef={inputRef}\n          autoComplete=\"off\"\n          placeholder={i18n.t`Promo codes`}\n          {...inputProps}\n          disabled={inputProps.disabled || orderModel.disableInteraction}\n        />\n      </InputGroup>\n      <CodesPanel data-testid=\"promoCodesPanel\">\n        {codes.map(({ id, code }) => (\n          <SecondaryButton\n            key={id}\n            role=\"button\"\n            disabled={orderModel.disableInteraction}\n            onClick={() => onCodeRemove(id)}\n          >\n            {`${code} `}\n          </SecondaryButton>\n        ))}\n      </CodesPanel>\n    </FormGroup>\n  ))\n})\n","import { useXFormCtx } from '@speedlo/xform'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport Spinner from 'react-spinkit'\n\nimport { PrimaryButton } from '../../common/Buttons'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { i18n } from '../../i18n'\nimport { useOrderFormCheck } from './hooks/useOrderFormCheck'\n\ninterface IProps {\n  children: ReactNode\n}\n\nexport const OrderSubmitButton = observer<IProps>(({ children }) => {\n  const xform = useXFormCtx()\n  const orderModel = useOrderModel()\n\n  const { hasItemsInCart } = useOrderFormCheck()\n\n  let submitBlocked = true\n  let submitBlockReason = ''\n\n  if (!hasItemsInCart) {\n    submitBlockReason = i18n.t`Cart is empty`\n  } else if (!orderModel.isVamInitialized) {\n    submitBlockReason = i18n.t`Agreements are not initialized yet`\n  } else if (!xform.state.isValid) {\n    submitBlockReason = i18n.t`Form validation failed`\n  } else {\n    submitBlocked = false\n  }\n\n  return (\n    <>\n      <PrimaryButton\n        id=\"OrderSubmitButton\"\n        title={submitBlockReason}\n        type=\"submit\"\n        color=\"primary\"\n        size=\"md\"\n        disabled={submitBlocked || xform.state.isSubmitting}\n      >\n        {xform.state.isSubmitting ? (\n          <Spinner name=\"circle\" fadeIn=\"none\" color=\"#ccc\" />\n        ) : (\n          children\n        )}\n      </PrimaryButton>\n    </>\n  )\n})\n","import { DateFormat, Trans } from '@lingui/react'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { SelectButtonThemed } from '../../common/Buttons'\nimport { useDelayedOrder } from '../../hooks/useDelayedOrder'\nimport { useOrderModel } from '../../hooks/useOrderModel'\n\nconst StyledOrderTimeButtons = styled.div`\n  margin: 0 0 1.4rem 0;\n  button {\n    position: relative;\n    padding-top: 0.3rem;\n    margin-bottom: 0.2rem;\n    height: 2.8rem;\n  }\n  button:first-of-type {\n    margin-right: 0.8rem;\n  }\n`\n\nexport const OrderTimeButtons = () => {\n  const orderModel = useOrderModel()\n\n  const { isEnabled, changeDeliveryTime } = useDelayedOrder()\n\n  return useObserver(() => {\n    if (!isEnabled) {\n      return null\n    }\n    return (\n      <StyledOrderTimeButtons>\n        <SelectButtonThemed\n          data-testid=\"orderTimeButtonNow\"\n          selected={!orderModel.isDelayed}\n          disabled={orderModel.disableInteraction}\n          onClick={() => changeDeliveryTime(null)}\n        >\n          <Trans>When possible</Trans>\n        </SelectButtonThemed>\n        <SelectButtonThemed\n          data-testid=\"orderTimeButtonLater\"\n          selected={orderModel.isDelayed}\n          disabled={orderModel.disableInteraction}\n          onClick={orderModel.openTimePicker}\n        >\n          {orderModel.isDelayed ? (\n            <DateFormat\n              value={orderModel.deliverAt}\n              format={{ weekday: 'long', hour: 'numeric', minute: 'numeric' }}\n            />\n          ) : (\n            <Trans>Choose time</Trans>\n          )}\n        </SelectButtonThemed>\n      </StyledOrderTimeButtons>\n    )\n  })\n}\n","import { Trans } from '@lingui/macro'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport { Alert, Button } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { mediaDesktop, mediaMobile } from '../../common/Responsive'\n\ninterface IProps {}\n\nconst NoticeButton = styled(Button)`\n  font-size: 0.9rem;\n  margin: 0.2rem 1rem;\n  padding: 0.5em 1rem;\n`\n\nconst StorageNotice = styled(Alert)`\n  width: 100%;\n  z-index: 5;\n  ${mediaDesktop`\n    font-size: 0.9rem;\n    position: sticky;\n    bottom: 0;\n  `};\n  ${mediaMobile`\n    position: fixed;\n    top: 5rem;\n    font-size: 0.8rem;\n    `};\n  padding: 0.5rem 1rem;\n  background-color: #d4eddadc;\n`\n\nexport const OrderFormStorageNotice: React.FC<IProps> = () => {\n  const { user } = useRoot()\n\n  return useObserver(() => {\n    if (user.rememberForm !== null) {\n      return null\n    }\n    return (\n      <StorageNotice\n        data-testid=\"OrderFormStorageNotice\"\n        className=\"animated slideInUp\"\n      >\n        <p>\n          <Trans>\n            This app is using secure storage for keeping filled form data. It's\n            not cookies, these are stored in your browser only.\n          </Trans>\n        </p>\n\n        <NoticeButton\n          color=\"success\"\n          size=\"sm\"\n          onClick={user.setFormRememberYes}\n          data-testid=\"orderFormStorageNotice__Yes\"\n        >\n          <Trans>Always remember</Trans>\n        </NoticeButton>\n        <NoticeButton\n          color=\"secondary\"\n          size=\"sm\"\n          onClick={user.setFormRememberNo}\n          data-testid=\"orderFormStorageNotice__No\"\n        >\n          <Trans>Do not store</Trans>\n        </NoticeButton>\n      </StorageNotice>\n    )\n  })\n}\n","import React from 'react'\n\nimport { PrimaryButton } from '../../common/Buttons'\nimport ButtonStripe from '../../common/ButtonStripe'\nimport { i18n } from '../../i18n'\n\ninterface IProps {\n  enabled: boolean\n  onClick(): void\n}\n\nexport const AddressSubmit: React.FC<IProps> = ({ enabled, onClick }) => (\n  <ButtonStripe>\n    <PrimaryButton\n      color=\"primary\"\n      disabled={!enabled}\n      onClick={onClick}\n      data-testid=\"AddressSubmit\"\n    >\n      {i18n.t`Confirm address`}\n    </PrimaryButton>\n  </ButtonStripe>\n)\n\nexport default AddressSubmit\n","import { cn } from '@speedlo/ui'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport { Input, InputProps } from 'reactstrap'\n\nimport { useRoot } from '../../../app/useRoot'\nimport { useDebounce } from '../../../hooks/useDebounce'\n\ninterface IProps {\n  onSearch: () => void\n  isVisible: boolean\n  inputProps: InputProps\n}\n\nexport const AddressSearchInput = observer<IProps>(\n  ({ onSearch, inputProps, isVisible }) => {\n    const { location } = useRoot()\n    const inputRef = React.useRef<Maybe<HTMLInputElement>>(null)\n\n    React.useEffect(\n      function autoFocus() {\n        if (isVisible && inputRef.current !== null) {\n          inputRef.current.focus()\n        }\n      },\n      [isVisible],\n    )\n\n    const onSearchDebounced = useDebounce(onSearch, 2000)\n\n    React.useEffect(() => {\n      return () => onSearchDebounced.clear()\n    }, [onSearchDebounced])\n\n    const onChange = function searchOnChangeDebounced(\n      ev: React.ChangeEvent<HTMLInputElement>,\n    ) {\n      const search = ev.target.value || ''\n      location.setSearchValue(search)\n      if (search.trim().length === 0) {\n        location.clearAddress()\n      }\n      onSearchDebounced()\n    }\n\n    const onKeyPress = function searchOnEnterKey(\n      ev: React.KeyboardEvent<HTMLInputElement>,\n    ) {\n      if (ev.key === 'Enter') {\n        onSearchDebounced.clear()\n        onSearch()\n      }\n    }\n\n    const onFocus = function autoSelectOnFocus() {\n      inputRef.current!.select()\n    }\n\n    return (\n      <Input\n        className={cn({ hidden: !isVisible })}\n        onChange={onChange}\n        onKeyPress={onKeyPress}\n        onFocus={onFocus}\n        value={location.searchValue}\n        innerRef={inputRef}\n        data-testid=\"SearchInput\"\n        {...inputProps}\n      />\n    )\n  },\n)\n","import debounce from 'debounce'\nimport React from 'react'\n\nexport function useDebounce(\n  cb: AnyFunction,\n  time: number = 300,\n  deps: React.DependencyList = [],\n) {\n  const debounced = React.useCallback(debounce(cb, time), [...deps, cb, time])\n\n  React.useEffect(() => {\n    return () => {\n      debounced.clear()\n    }\n  }, [debounced])\n\n  return debounced\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../../app/useRoot'\nimport { useAlertModal } from '../../../hooks/useAlertModal'\nimport { i18n } from '../../../i18n'\n\nexport const GeolocationButton = observer(() => {\n  const { location } = useRoot()\n\n  const [alert, makeAlert] = useAlertModal()\n\n  if (!location.isGeolocationAvailable || location.isResolving) {\n    return null\n  }\n\n  const attemptGeolocation = () => {\n    location.log('geolocating...')\n    navigator.geolocation.getCurrentPosition(\n      ({ coords }) => {\n        const { latitude, longitude } = coords\n        location.log(\n          'geolocated at coords %s, %s (acc: %s)',\n          coords.latitude,\n          coords.longitude,\n          coords.accuracy,\n        )\n        location.setGeolocationPoint({ latitude, longitude })\n      },\n      err => {\n        location.log('failed geolocation', err)\n        location.disableGeolocation()\n        makeAlert(\n          i18n.t`Geolocation failed`,\n          i18n.t`Your browser does not support geolocation.`,\n        )\n      },\n      {\n        enableHighAccuracy: true,\n        maximumAge: 60 * 1000,\n      },\n    )\n  }\n\n  return (\n    <>\n      {alert}\n      <div className=\"gps\" onClick={attemptGeolocation}>\n        <span className=\"flaticon-gps\" />\n      </div>\n    </>\n  )\n})\n\nexport default GeolocationButton\n","import { cn } from '@speedlo/ui'\nimport React from 'react'\nimport Spinner from 'react-spinkit'\n\ninterface IProps {\n  address: string\n  isVisible: boolean\n  isResolving: boolean\n  onValidClick(): void\n}\n\nexport const ResolvedAddress: React.FC<IProps> = ({\n  address,\n  isVisible,\n  isResolving,\n  onValidClick,\n}) => {\n  return (\n    <div\n      data-testid=\"ResolvedAddress\"\n      className={cn('resolved__address', {\n        wait: isResolving,\n        hidden: !isVisible,\n      })}\n      onClick={isResolving ? undefined : onValidClick}\n    >\n      {isResolving ? <Spinner name=\"ball-beat\" fadeIn=\"none\" /> : address}\n    </div>\n  )\n}\n","import { useReaction } from '@speedlo/hooks'\nimport { debounce } from 'debounce'\nimport { reaction } from 'mobx'\nimport { useLocalStore } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../../app/useRoot'\n\ninterface IAddressSearchOptions {\n  count?: number\n  watchLocation?: boolean\n}\n\nexport type AddressSearchResult = ReturnType<typeof mapResult>\n\nconst urlCache = new Map()\n\nexport function useAddressSearch({\n  count = 1,\n  watchLocation = false,\n}: IAddressSearchOptions = {}) {\n  const { map, location } = useRoot()\n\n  const state = useLocalStore(() => ({\n    results: null as RoA<AddressSearchResult> | null,\n    phrase: location.searchValue,\n    searching: false,\n    get url() {\n      const params = [\n        `count=${count}`,\n        `lon=${map.longitude}`,\n        `lat=${map.latitude}`,\n        `zoom=${map.zoom}`,\n        `lang=cs,sk,en`,\n        `enableCategories=1`,\n      ]\n      return `https://api.mapy.cz/suggest/?${params.join('&')}`\n    },\n  }))\n\n  const doFetch = React.useCallback(() => {\n    if (state.phrase.length === 0) {\n      state.results = null\n      return\n    }\n\n    location.log(`searching phrase: ${state.phrase}`)\n    const url = `${state.url}&phrase=${state.phrase}`\n\n    if (urlCache.has(url)) {\n      state.results = urlCache.get(url)\n      return\n    }\n\n    state.searching = true\n\n    fetch(url)\n      .then(resp => resp.json())\n      .then(json => {\n        const results = json.result.filter(validateResult).map(mapResult)\n        urlCache.set(url, results)\n        state.results = results\n      })\n      .finally(() => {\n        state.searching = false\n      })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [location])\n\n  const debouncedFetch = React.useRef(debounce(doFetch, 500))\n\n  const onSearch = React.useCallback(\n    (nextPhrase: string = location.searchValue) => {\n      location.log(`onSearch ${nextPhrase}`)\n      state.phrase = nextPhrase.trim()\n      debouncedFetch.current.clear()\n      doFetch()\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [doFetch, location],\n  )\n\n  useReaction(\n    () => location.searchValue,\n    value => {\n      if (value.length === 0) {\n        state.phrase = ''\n        state.results = null\n        debouncedFetch.current.clear()\n      }\n    },\n  )\n\n  React.useEffect(\n    () =>\n      reaction(\n        () => state.url,\n        () => {\n          if (watchLocation) {\n            debouncedFetch.current()\n          }\n        },\n      ),\n    [state.url, watchLocation],\n  )\n\n  return { ...state, onSearch }\n}\n\nfunction validateResult({ userData }) {\n  const { latitude, longitude } = userData\n  return latitude && longitude\n}\n\nfunction mapResult({ category, userData }) {\n  const {\n    id,\n    latitude,\n    longitude,\n    suggestFirstRow,\n    suggestSecondRow,\n    municipality,\n    district,\n    country,\n  } = userData\n\n  const suffix =\n    [municipality, district, country, suggestSecondRow].find(Boolean) || ''\n\n  return {\n    id,\n    category,\n    gps: {\n      latitude,\n      longitude,\n    },\n    address: `${suggestFirstRow}${suffix ? `, ${suffix}` : ''}`,\n  }\n}\n","import { Trans } from '@lingui/macro'\nimport { useReaction } from '@speedlo/hooks'\nimport { cn } from '@speedlo/ui'\nimport { observer, useLocalStore } from 'mobx-react-lite'\nimport React from 'react'\nimport { Button } from 'reactstrap'\nimport styled from 'styled-components'\n\nimport { useRoot } from '../../app/useRoot'\nimport { useAddressSearch } from './hooks/useAddressSearch'\n\ninterface IProps {}\n\nconst Styled = styled.div`\n  position: absolute;\n  margin-top: 0.1rem;\n\n  > div,\n  button.hint:hover {\n    background-color: #ffffffaa;\n  }\n\n  > div {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    border: 1px solid transparent;\n    border-radius: 0.4rem;\n    padding: 0.375rem 0.75rem;\n    font-size: 1rem;\n    line-height: 1.5;\n    max-width: 25rem;\n    text-align: left;\n\n    & > p {\n      font-size: 0.8rem;\n      color: gray;\n    }\n\n    button {\n      &:hover,\n      &:hover:focus {\n        text-decoration: none;\n      }\n    }\n\n    button.done {\n      color: darkgray;\n    }\n  }\n\n  button.hint {\n    color: coral;\n    text-shadow: 0.5px 0.5px darkgray;\n    &:hover {\n      text-decoration: none;\n      transition: background-color 0.5s ease;\n    }\n  }\n`\n\nexport const ExtraAddressResult = observer<IProps>(props => {\n  const { location } = useRoot()\n  const state = useLocalStore(() => ({\n    open: false,\n  }))\n\n  const { results, searching, onSearch } = useAddressSearch({\n    count: 5,\n    watchLocation: state.open,\n  })\n\n  useReaction(\n    () => state.open,\n    open => {\n      if (open) {\n        onSearch()\n      }\n    },\n  )\n\n  useReaction(\n    () => location.searchValue,\n    () => {\n      state.open = false\n    },\n  )\n\n  if (!location.hasSearchValue) {\n    return null\n  }\n\n  const usefulResults =\n    results && results.filter(({ address }) => address !== location.address)\n\n  const renderHint = () => (\n    <Button\n      className=\"hint\"\n      color=\"link\"\n      onClick={() => {\n        state.open = true\n      }}\n    >\n      <Trans>Looking for a different address?</Trans>\n    </Button>\n  )\n\n  const renderResults = () => (\n    <div>\n      <p>\n        <Trans>\n          Hint: Try moving map around and zooming closer to your location to\n          improve these results.\n        </Trans>\n      </p>\n      {searching && <div>...</div>}\n      {usefulResults &&\n        usefulResults.map(result => (\n          <Button\n            size=\"sm\"\n            color=\"link\"\n            key={result.id}\n            onClick={() => {\n              location.setSearchResult(result)\n              state.open = false\n            }}\n          >\n            {result.address}\n          </Button>\n        ))}\n      <Button\n        size=\"sm\"\n        color=\"link\"\n        onClick={() => {\n          state.open = false\n        }}\n        className=\"done\"\n      >\n        {usefulResults && usefulResults.length === 0 ? (\n          <Trans>No match for map location</Trans>\n        ) : (\n          <Trans>I don't see anything useful here.</Trans>\n        )}\n      </Button>\n    </div>\n  )\n\n  return (\n    <Styled\n      className={cn('animated', {\n        bounceInLeft: state.open,\n        bounceIn: !state.open,\n      })}\n      key={state.open.toString()}\n    >\n      {state.open ? renderResults() : renderHint()}\n    </Styled>\n  )\n})\n","import { Trans } from '@lingui/macro'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport { Alert } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { mediaDesktop } from '../../common/Responsive'\nimport { gpsToLatLngLit } from '../../helpers/gps'\nimport { i18n } from '../../i18n'\nimport { AddressSearchInput } from './destination/AddressSearchInput'\nimport GeolocationButton from './destination/GeolocationButton'\nimport { ResolvedAddress } from './destination/ResolvedAddress'\nimport { ExtraAddressResult } from './ExtraAddressResult'\nimport { useAddressSearch } from './hooks/useAddressSearch'\n\nconst Styled = styled.div`\n  width: 90%;\n  min-width: 14rem;\n  margin: 1rem auto;\n  text-align: center;\n\n  div.container {\n    display: flex;\n    border-radius: 1rem;\n    border: 1px solid #d4d4d4;\n    background-color: white;\n    ${mediaDesktop`\n    height: 2.3rem;\n    `}\n  input {\n    height: auto;\n    background: transparent;\n    border: none;\n    &:focus {\n      box-shadow: initial;\n    }\n    &.hidden {\n      display: none;\n    }\n  }\n\n  div.gps {\n    color: ${({ theme }) => theme.secondary};\n    cursor: pointer;\n    position: relative;\n    top: 0.2rem;\n  }\n\n  div.resolved__address {\n    margin: 0.4rem 0.7rem 0.4rem 0.7rem;\n    font-size: 1rem;\n    color: green;\n    width: 100%;\n    cursor: pointer;\n    &.hidden {\n      display: none;\n    }\n    &.wait {\n      display: flex;\n      justify-content: center;\n      font-size: 0.5rem;\n      cursor: wait;\n    }\n  }\n\n  .alert {\n    pointer-events: none;\n    margin-bottom: 0;\n  }\n`\n\nexport const DeliveryAddressSearch = observer(() => {\n  const { map, location } = useRoot()\n\n  const { results, searching, onSearch } = useAddressSearch()\n\n  React.useEffect(() => {\n    if (searching) {\n      location.setIsResolving(searching)\n    }\n  }, [location, searching])\n\n  React.useEffect(() => {\n    if (results === null) {\n      return\n    }\n\n    if (results.length === 0) {\n      location.log('no result from direct geocoder api')\n      location.setAsNotResolved()\n      return\n    }\n\n    const [singleResult] = results\n    const {\n      category,\n      gps: { latitude, longitude },\n    } = singleResult\n\n    if (map.mapRef) {\n      map.log(`panning to result gps ${latitude} / ${longitude}`)\n      map.mapRef.panTo(gpsToLatLngLit(singleResult.gps))\n    }\n\n    if (!(category && category.startsWith('address'))) {\n      location.log('result with category %s', category)\n      location.setAsNotAddress()\n      return\n    }\n\n    location.log(`found address ${singleResult.address}`)\n    if (location.latitude !== latitude && location.longitude !== longitude) {\n      location.resetResolution()\n    }\n    location.setSearchResult(singleResult)\n  }, [location, map, results])\n\n  return (\n    <Styled>\n      <div className=\"container\">\n        <ResolvedAddress\n          address={location.address || ''}\n          isVisible={location.hasAddress}\n          isResolving={location.isResolving}\n          onValidClick={location.clearAddress}\n        />\n        <AddressSearchInput\n          inputProps={{\n            placeholder: i18n.t`Type address or choose it from map`,\n            autoComplete: 'shipping street-address',\n          }}\n          onSearch={onSearch}\n          isVisible={!(location.hasAddress || location.isResolving)}\n        />\n        <GeolocationButton />\n      </div>\n      <ErrorMessage />\n      <ExtraAddressResult />\n    </Styled>\n  )\n})\n\nfunction ErrorMessage() {\n  const { location } = useRoot()\n  if (!location.hasResolutionResult) {\n    return null\n  }\n  if (location.isResolved === false) {\n    return (\n      <Alert color=\"danger\">\n        <Trans>Address was not recognized.</Trans>\n      </Alert>\n    )\n  }\n  if (location.isStreetAddress === false) {\n    return (\n      <Alert color=\"warning\">\n        <Trans>Please enter address with house number.</Trans>\n      </Alert>\n    )\n  }\n  if (location.inDeliveryLocation === false) {\n    return (\n      <Alert color=\"warning\">\n        <Trans>\n          Meal can't be delivered to your chosen address by any restaurant.\n        </Trans>\n      </Alert>\n    )\n  }\n  return null\n}\n","import { Marker } from '@react-google-maps/api'\nimport { useReaction, useWhen } from '@speedlo/hooks'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport { GeoPoint, latLngToGps } from '../../helpers/gps'\nimport { useLocationResolver } from '../../hooks/useLocationResolver'\nimport { useFoodMenuQuery } from '../foodMenu/hooks/useFoodMenuQuery'\nimport { AddressSubmit } from './AddressSubmit'\nimport { DeliveryAddressSearch } from './DeliveryAddressSearch'\nimport { useDeliveryMapPanning } from './hooks/useDeliveryMapPanning'\nimport { useOrderCreate } from './hooks/useOrderCreate'\n\ninterface IProps {\n  onConfirm(): void\n}\n\nconst StyledDeliveryMap = styled.div`\n  .delivery__map__address {\n    position: absolute;\n    top: 0;\n    left: 2.3rem;\n    right: 2.3rem;\n  }\n  .delivery__map__submit {\n    position: absolute;\n    bottom: 3rem;\n    width: 100%;\n  }\n`\n\nexport const DeliveryMap = observer<IProps>(({ onConfirm }) => {\n  const { map, location, business } = useRoot()\n\n  const resolver = useLocationResolver()\n\n  const resolveUserLocation = (gps: GeoPoint) => {\n    location.resetResolution()\n    location.setSearchValue('')\n    location.setLocation(gps)\n  }\n\n  useWhen(\n    () => business.isValid,\n    () => {\n      if (location.hasLocation && !location.hasResolutionResult) {\n        location.log('resolving initial gps')\n        resolver(location.geoPoint!)\n      }\n    },\n  )\n\n  useReaction(\n    () => location.geoPoint,\n    gps => {\n      if (gps) {\n        location.log('resolving on gps change')\n        resolver(gps)\n      }\n    },\n  )\n\n  useReaction(\n    () => map.clickPoint,\n    clickPoint => {\n      if (clickPoint) {\n        location.log(`resolve with clickpoint`)\n        resolveUserLocation(clickPoint)\n        map.clearClickPoint()\n      }\n    },\n  )\n\n  // prefetch food menu when correct address is resolved\n  useFoodMenuQuery(location.isDeliveryAddress ? location.branchId : null)\n  useDeliveryMapPanning()\n\n  const { createDeliveryOrder } = useOrderCreate(onConfirm)\n\n  return (\n    <StyledDeliveryMap data-testid=\"DeliverMap\">\n      {location.latLng ? (\n        <Marker\n          position={location.latLng}\n          draggable={true}\n          onDragEnd={({ latLng }) => {\n            location.log(`resolve with drag`)\n            resolveUserLocation(latLngToGps(latLng))\n          }}\n        />\n      ) : null}\n      <div className=\"delivery__map__address\">\n        <DeliveryAddressSearch />\n      </div>\n      <div className=\"delivery__map__submit\">\n        <AddressSubmit\n          enabled={location.isDeliveryAddress && !location.isResolving}\n          onClick={createDeliveryOrder}\n        />\n      </div>\n    </StyledDeliveryMap>\n  )\n})\n","import React from 'react'\n\nimport { useRoot } from '../app/useRoot'\nimport { useExecutableQResolveLocation } from '../graph/generated'\nimport { GeoPoint } from '../helpers/gps'\n\nexport function useLocationResolver() {\n  const { location } = useRoot()\n\n  const [resolveLocation] = useExecutableQResolveLocation({\n    fetchPolicy: 'cache-first',\n  })\n\n  const resolver = React.useCallback(\n    async (gps: GeoPoint) => {\n      location.setIsResolving(true)\n\n      const data = await resolveLocation({\n        ...location.resolutionTarget,\n        ...gps,\n      })\n\n      if (data !== null) {\n        location.setResolutionResult(data.resolveLocation)\n      }\n      location.setIsResolving(false)\n    },\n    [location, resolveLocation],\n  )\n\n  return resolver\n}\n","import { useAutorun, useReaction } from '@speedlo/hooks'\nimport { useAsObservableSource } from 'mobx-react-lite'\n\nimport { useRoot } from '../../../app/useRoot'\nimport { useQInitialDeliveryLocation } from '../../../graph/generated'\nimport { useMapPanning } from './useMapPanning'\n\nexport const useDeliveryMapPanning = () => {\n  const { location } = useRoot()\n  const { data, loading } = useQInitialDeliveryLocation(\n    {},\n    {\n      fetchPolicy: 'cache-first',\n      skip: location.hasAddress,\n    },\n  )\n\n  const source = useAsObservableSource({\n    initial: loading ? null : data.location,\n  })\n\n  const panToGps = useMapPanning()\n\n  useAutorun(() => {\n    if (location.geoPoint) {\n      location.log('pan to user location', location.geoPoint)\n      panToGps(location.geoPoint)\n    } else if (location.geolocationPoint) {\n      location.log('pan to geolocation', location.geolocationPoint)\n      panToGps(location.geolocationPoint)\n    } else if (source.initial && source.initial.gpsCoordinates) {\n      location.log('pan to initial location', source.initial.gpsCoordinates)\n      panToGps(source.initial.gpsCoordinates)\n    }\n  })\n\n  useReaction(\n    () => location.geolocationPoint,\n    gps => {\n      if (gps) {\n        panToGps(gps)\n      }\n    },\n  )\n}\n","import { t } from '@lingui/macro'\nimport React, { CSSProperties } from 'react'\n\nimport { i18n } from '../../i18n'\n\ninterface IProps {\n  minCount: number\n  maxCount: number\n  isValid: boolean\n}\n\nexport const CategoryValidationMessage: React.FC<IProps> = ({\n  minCount,\n  maxCount,\n  isValid,\n}) => {\n  let message = ''\n  if (minCount === 0) {\n    if (maxCount > 0) {\n      message = i18n._(t`maximum ${maxCount}`)\n    } else {\n      return null\n    }\n  } else if (maxCount === 0) {\n    message = i18n._(t`minimum ${minCount}`)\n  } else if (minCount === maxCount) {\n    const count = minCount\n    message = i18n._(t`only ${count}`)\n  } else {\n    message = i18n._(t`minimum ${minCount} and maximum ${maxCount}`)\n  }\n  const style: CSSProperties = {}\n  if (!isValid) {\n    style.color = 'red'\n  }\n  return (\n    <span style={style}>\n      {'('}\n      {message}\n      {')'}\n    </span>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\ninterface IProps {\n  onClick(): void\n}\n\nconst StyledSidedishRemoveButton = styled.div`\n  position: absolute;\n  left: -0.6rem;\n  top: -0.4rem;\n  width: 2rem;\n  height: 2rem;\n  border-radius: 1rem;\n  background: ${({ theme }) => theme.primary};\n\n  &:hover {\n    background: ${({ theme }) => theme.primaryHover} !important;\n  }\n  &:active {\n    background: ${({ theme }) => theme.primary} !important;\n  }\n  & .rectangle {\n    width: 45%;\n    position: absolute;\n    top: 45%;\n    left: 30%;\n    height: 4px;\n    background: white;\n  }\n`\nexport const SidedishRemoveButton: React.FC<IProps> = ({\n  onClick,\n  ...props\n}) => {\n  return (\n    <StyledSidedishRemoveButton\n      onClick={onClick}\n      className=\"animated bounceIn\"\n      data-testid=\"SidedishRemoveButton\"\n      {...props}\n    >\n      <div className=\"rectangle\" />\n    </StyledSidedishRemoveButton>\n  )\n}\n","import React from 'react'\nimport { ButtonProps } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { PickerButton } from '../../common/PickerButton'\nimport { FRecipeDetailSideDishes } from '../../graph/generated'\nimport { SidedishRemoveButton } from './SidedishRemoveButton'\n\ninterface IProps extends ButtonProps {\n  sidedish: FRecipeDetailSideDishes\n  count: number\n  isSelected: boolean\n  canBeSelected: boolean\n  canBeRemoved: boolean\n  onAdd(): void\n  onRemove(): void\n}\n\nconst StyledSidedishCheckbox = styled.div`\n  display: inline-block;\n  position: relative;\n\n  & .name {\n    float: left;\n    text-align: left;\n    white-space: normal;\n    max-width: 13rem;\n  }\n\n  & .price {\n    font-weight: bold;\n    float: right;\n  }\n\n  & .count {\n    display: inline-block;\n    margin-left: 0.5rem;\n  }\n`\n\nexport const SidedishCheckbox = React.memo<IProps>(\n  ({\n    sidedish,\n    count,\n    canBeSelected,\n    canBeRemoved,\n    className,\n    onAdd,\n    onRemove,\n    ...buttonProps\n  }) => {\n    const onClick = React.useCallback(() => {\n      if (canBeSelected) {\n        onAdd()\n      }\n    }, [canBeSelected, onAdd])\n    return (\n      <StyledSidedishCheckbox className={className}>\n        <PickerButton\n          onClick={onClick}\n          disabled={!canBeSelected}\n          size=\"xs\"\n          outline={true}\n          width=\"17.5rem\"\n          data-testid={`sidedishCheckbox__${sidedish.id}`}\n          {...buttonProps}\n        >\n          <div className=\"name\">\n            {sidedish.nameLabel}\n            <span key={count} className=\"animated heartBeat count\">\n              {count > 1 && `${count}x`}\n            </span>\n          </div>\n          <div className=\"price\">{sidedish.price.formattedValue}</div>\n        </PickerButton>\n        {canBeRemoved && <SidedishRemoveButton onClick={onRemove} />}\n      </StyledSidedishCheckbox>\n    )\n  },\n)\n","import { useSideDishValidator } from '@speedlo/cart'\nimport React, { Fragment } from 'react'\nimport styled from 'styled-components'\n\nimport { FRecipeDetailFragment } from '../../graph/generated'\nimport { CategoryValidationMessage } from './CategoryValidationMessage'\nimport { SidedishCheckbox } from './SidedishCheckbox'\n\ninterface IProps {\n  recipe: FRecipeDetailFragment\n  selection: ReadonlyArray<ID>\n  onAdd(item: ID): void\n  onRemove(item: ID): void\n}\n\nconst StyledSidedishPicker = styled.div`\n  margin-top: 1rem;\n\n  & .sidedish__picker__checkbox {\n    @media (max-width: 370px) {\n      width: 100%;\n    }\n  }\n\n  & .sidedish__picker__category {\n    font-size: 1rem;\n    font-weight: bold;\n    text-align: left;\n    margin: 0 0 0.2rem 0.2rem;\n  }\n`\n\nexport const SidedishPicker: React.FC<IProps> = ({\n  recipe,\n  selection,\n  onAdd,\n  onRemove,\n}) => {\n  const { canBeSelected, isCategoryValid } = useSideDishValidator(\n    recipe.categories,\n    selection,\n  )\n\n  return (\n    <StyledSidedishPicker className=\"food__sidedish__picker\">\n      {recipe.categories.map(category => (\n        <Fragment key={category.id}>\n          <div className=\"sidedish__picker__category\">\n            {category.nameLabel}{' '}\n            <CategoryValidationMessage\n              minCount={category.minCount}\n              maxCount={category.maxCount}\n              isValid={isCategoryValid(category)}\n            />\n          </div>\n          {category.sideDishes.map(sidedish => (\n            <SidedishCheckbox\n              key={`${sidedish.id}-${category.id}`}\n              sidedish={sidedish}\n              count={selection.filter(i => i === sidedish.id).length}\n              isSelected={selection.includes(sidedish.id)}\n              canBeRemoved={selection.includes(sidedish.id)}\n              canBeSelected={canBeSelected(category, sidedish)}\n              onAdd={() => onAdd(sidedish.id)}\n              onRemove={() => onRemove(sidedish.id)}\n              className=\"sidedish__picker__checkbox\"\n            />\n          ))}\n        </Fragment>\n      ))}\n    </StyledSidedishPicker>\n  )\n}\n","import { useSideDishValidator } from '@speedlo/cart'\nimport { cn } from '@speedlo/ui'\nimport React from 'react'\n\nimport { PrimaryButton } from '../../common/Buttons'\nimport { FRecipeDetailFragment } from '../../graph/generated'\nimport { i18n } from '../../i18n'\n\ninterface IProps {\n  selection: ReadonlyArray<ID>\n  recipe: Maybe<FRecipeDetailFragment>\n  onConfirm(): Promise<boolean>\n}\n\nexport const CartOrderButton = React.memo<IProps>(\n  ({ selection, recipe, onConfirm }) => {\n    const [isConfirming, setConfirming] = React.useState(false)\n    const { isCategoryValid } = useSideDishValidator(\n      recipe ? recipe.categories : [],\n      selection,\n    )\n\n    return (\n      <PrimaryButton\n        className={cn('modal__body__button', 'animated', {\n          heartBeat: isConfirming,\n        })}\n        disabled={\n          isConfirming || !recipe || !recipe.categories.every(isCategoryValid)\n        }\n        data-testid=\"CartOrderButton\"\n        onClick={() => {\n          setConfirming(true)\n          onConfirm().catch(() => {\n            setConfirming(false)\n          })\n        }}\n      >\n        {i18n.plural({\n          value: selection.length,\n          0: 'Order without sidedish',\n          one: 'Order with this sidedish',\n          other: 'Order with # sidedishes',\n        })}\n      </PrimaryButton>\n    )\n  },\n)\n","import '../../common/Modal.css'\n\nimport { Trans } from '@lingui/macro'\nimport { RM } from '@speedlo/tools'\nimport React from 'react'\nimport { Container, Modal, ModalBody, ModalHeader } from 'reactstrap'\n\nimport Pacman from '../../common/Pacman'\nimport { FRecipeDetailFragment } from '../../graph/generated'\nimport { SidedishPicker } from '../sidedishPicker/SidedishPicker'\nimport { CartOrderButton } from './CartOrderButton'\n\ninterface IProps {\n  recipe: Maybe<FRecipeDetailFragment>\n  isLoading: boolean\n  initialSideDishes?: ID[]\n  onConfirm(selection: ID[]): Promise<boolean>\n  onClose(): void\n}\n\nconst EMPTY_SELECTION = []\n\nexport const CartModal: React.FC<IProps> = ({\n  recipe,\n  isLoading,\n  initialSideDishes = EMPTY_SELECTION,\n  onConfirm,\n  onClose,\n}) => {\n  const [selection, updateSelection] = React.useState([] as string[])\n\n  React.useEffect(() => {\n    updateSelection(initialSideDishes)\n  }, [initialSideDishes])\n\n  const onCloseModal = React.useCallback(() => {\n    updateSelection([])\n    onClose()\n  }, [onClose])\n\n  const onConfirmAndClose = async () => {\n    if (await onConfirm(selection)) {\n      onCloseModal()\n      return true\n    }\n    return false\n  }\n\n  const onAddSidedish = (sidedishId: ID) => {\n    updateSelection(sel => {\n      return RM.append(sidedishId, sel)\n    })\n  }\n\n  const onRemoveSidedish = (sidedishId: ID) => {\n    updateSelection(sel => {\n      return RM.remove(RM.indexOf(sidedishId, sel), 1, sel)\n    })\n  }\n\n  const renderBody = () => {\n    if (isLoading) {\n      return <Pacman />\n    }\n    if (!recipe) {\n      return (\n        <Trans>We sorry, but the item is unavailable at this moment.</Trans>\n      )\n    }\n    return (\n      <>\n        <h3 className=\"modal__body__food__name\">{recipe.nameLabel}</h3>\n        <span className=\"modal__body__food_description\">\n          {recipe.descriptionLabel}\n        </span>\n        <SidedishPicker\n          recipe={recipe}\n          selection={selection}\n          onAdd={onAddSidedish}\n          onRemove={onRemoveSidedish}\n        />\n      </>\n    )\n  }\n\n  return (\n    <Modal\n      isOpen={recipe !== null}\n      toggle={onCloseModal}\n      className=\"modal__container\"\n      autoFocus={true}\n      backdrop=\"static\"\n      fade={false}\n      data-testid=\"CartModal\"\n    >\n      <ModalHeader\n        toggle={onCloseModal}\n        tag={Container}\n        className=\"modal__header\"\n      >\n        <span>\n          <Trans>Do you want to add something?</Trans>\n        </span>\n      </ModalHeader>\n      <ModalBody className=\"modal__body\">\n        <div className=\"modal__body__content\">{renderBody()}</div>\n        <div className=\"modal__body__button__line\">\n          <div className=\"modal__body__button__strip\" />\n          <CartOrderButton\n            recipe={recipe}\n            selection={selection}\n            onConfirm={onConfirmAndClose}\n          />\n        </div>\n      </ModalBody>\n    </Modal>\n  )\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useQCartRecipe } from '../../graph/generated'\nimport { useAddToCart } from '../../hooks/useAddToCart'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { CartModal } from './CartModal'\n\ninterface IProps {\n  orderId: MaybeID\n}\n\nexport const AddToCartModal = observer<IProps>(({ orderId }) => {\n  const orderModel = useOrderModel()\n\n  const recipeId = orderModel.addToCartRecipeId\n\n  const { data, loading } = useQCartRecipe(\n    {\n      recipeId: recipeId!,\n    },\n    { skip: orderId === null || recipeId === null, fetchPolicy: 'cache-first' },\n  )\n\n  const executeAddToCart = useAddToCart()\n\n  const onConfirm = React.useCallback(\n    async sideDishes => {\n      if (orderId === null || recipeId === null) {\n        return false\n      }\n      const result = await executeAddToCart(recipeId, sideDishes)\n      return Boolean(result)\n    },\n    [executeAddToCart, orderId, recipeId],\n  )\n\n  const onClose = React.useCallback(() => {\n    orderModel.addToCart(null)\n  }, [orderModel])\n\n  return (\n    <CartModal\n      recipe={loading ? null : data.recipe}\n      onConfirm={onConfirm}\n      onClose={onClose}\n      isLoading={loading}\n    />\n  )\n})\n","import { RM } from '@speedlo/tools'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../app/useRoot'\nimport { useMChangeCartItem, useQCartItem } from '../../graph/generated'\nimport { CartModal } from './CartModal'\n\ninterface IProps {\n  orderId: MaybeID\n}\n\nexport const ChangeCartModal = observer<IProps>(({ orderId }) => {\n  const { order: orderModel, cart: cartModel } = useRoot()\n\n  const itemId = orderModel.changeCartItemId\n\n  const { data, loading } = useQCartItem(\n    {\n      itemId: itemId!,\n    },\n    { skip: orderId === null || itemId === null },\n  )\n\n  const [changeItem] = useMChangeCartItem()\n\n  const onConfirm = React.useCallback(\n    async sideDishes => {\n      if (orderId === null || itemId === null) {\n        return false\n      }\n      const result = await changeItem({\n        itemId,\n        sideDishes,\n        orderId,\n        withGoods: cartModel.withGoods,\n      })\n      return Boolean(result)\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [orderId, itemId, changeItem],\n  )\n\n  const onClose = React.useCallback(() => {\n    orderModel.changeCartItem(null)\n  }, [orderModel])\n\n  const sideDishesSelection = React.useMemo(\n    () =>\n      loading\n        ? undefined\n        : (data.item.sideDishes.map(RM.path(['recipe', 'id'])) as string[]),\n    [loading, data],\n  )\n\n  return (\n    <CartModal\n      recipe={loading ? null : data.item.recipe}\n      initialSideDishes={sideDishesSelection}\n      onConfirm={onConfirm}\n      onClose={onClose}\n      isLoading={loading}\n    />\n  )\n})\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { AddToCartModal } from './AddToCartModal'\nimport { CartSystem } from './CartSystem'\nimport { ChangeCartModal } from './ChangeCartModal'\n\ninterface IProps {\n  isReadonly?: boolean\n}\n\nexport const CartView = observer<IProps>(({ isReadonly = false }) => {\n  const orderModel = useOrderModel()\n  const orderId = orderModel.orderId\n  return (\n    <>\n      <AddToCartModal orderId={orderId} />\n      <ChangeCartModal orderId={orderId} />\n      <CartSystem\n        orderId={orderId}\n        isReadonly={isReadonly || orderModel.disableInteraction}\n      />\n    </>\n  )\n})\n","import { cn } from '@speedlo/ui'\nimport React, { useState } from 'react'\nimport Scroll from 'react-scroll'\nimport Truncate from 'react-truncate'\nimport styled from 'styled-components/macro'\n\nimport { mediaDesktop, mediaMobile } from '../../common/Responsive'\nimport { FFoodMenuCategoryFragment } from '../../graph/generated'\n\ninterface IProps {\n  categories: ReadonlyArray<FFoodMenuCategoryFragment>\n}\n\nconst StyledCategoryNavigator = styled.div`\n  background-color: #d4d4d4;\n  border-top-left-radius: 0.6rem;\n  padding: 0.7rem 0.5rem 0 0.2rem;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n  user-select: none;\n  display: flex;\n  ${mediaDesktop`\n    flex-wrap: wrap;\n  `}\n  ${mediaMobile`\n    flex-wrap: nowrap;\n    overflow-x: auto;\n    overflow-y: hidden;\n    box-shadow: inset -15px -5px 15px -14px rgba(0, 0, 0, 0.6);\n    margin: 0;\n    border-top-left-radius: 0;\n    background-color: #f3f3f3;\n    opacity: 0.94;\n  `}\n\n  a.link {\n    text-align: center;\n    color: #595959 !important;\n    display: inline-block;\n    min-width: 4rem;\n    cursor: pointer;\n    margin: 0 0.2rem;\n    &:hover,\n    &.active {\n      color: #5ca651 !important;\n      border-color: #5ca651;\n    }\n  }\n  div.circle {\n    background-color: white;\n    border: 1px solid #595959;\n    border-radius: 2rem;\n    width: 2.6rem;\n    height: 2.6rem;\n    margin: 0 auto;\n    padding: 0;\n    &:hover,\n    a.link.active > & {\n      border-color: #5ca651;\n    }\n    & span::before,\n    & span::after {\n      margin: 0;\n      padding: 0;\n      font-size: 1.7rem;\n    }\n  }\n\n  div.description {\n    font-size: 0.9rem;\n    margin-top: 0.2rem;\n    max-width: 5rem;\n  }\n`\nconst CategoryNavigator: React.FC<IProps> = ({ categories }) => {\n  const [activeCategoryIndex, setActiveCategoryIndex] = useState(0)\n  return (\n    <StyledCategoryNavigator data-testid=\"CategoryNavigator\">\n      {categories.length === 0\n        ? null\n        : categories.map((category, idx) => (\n            <Scroll.Link\n              to={category.nameLabel}\n              key={category.id}\n              className={cn('link', {\n                active: activeCategoryIndex === idx,\n              })}\n              onSetActive={() => setActiveCategoryIndex(idx)}\n              offset={-168}\n              smooth={true}\n              spy={true}\n              title={category.nameLabel}\n            >\n              <div className=\"circle\">\n                <span className={`flaticon-${category.pictogram}`} />\n              </div>\n              <div className=\"description\">\n                <Truncate lines={2}>{category.nameLabel}</Truncate>\n              </div>\n            </Scroll.Link>\n          ))}\n    </StyledCategoryNavigator>\n  )\n}\n\nexport default CategoryNavigator\n","import React from 'react'\nimport Scroll from 'react-scroll'\nimport styled from 'styled-components/macro'\n\nimport { mediaMobile } from '../../common/Responsive'\nimport { FFoodMenuCategoryFragment } from '../../graph/generated'\n\ninterface IProps {\n  category: FFoodMenuCategoryFragment\n}\n\nconst FoodCategoryStyled = styled.div`\n  color: #474747;\n  display: block;\n  font-size: 1.6rem;\n  & a {\n    text-decoration: none;\n  }\n`\n\nconst FoodCategoryTitleStyled = styled('h3')`\n  ${mediaMobile`margin: 1rem 0 0.4rem 1rem;`};\n`\n\nconst FoodCategory: React.FC<IProps> = ({ category, children }) => (\n  <Scroll.Element name={category.nameLabel}>\n    <FoodCategoryStyled>\n      <FoodCategoryTitleStyled>{category.nameLabel}</FoodCategoryTitleStyled>\n      {children}\n    </FoodCategoryStyled>\n  </Scroll.Element>\n)\n\nexport default React.memo(FoodCategory)\n","import './FoodMenuItem.css'\n\nimport { cn } from '@speedlo/ui'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport Truncate from 'react-truncate'\nimport styled from 'styled-components/macro'\n\nimport { mediaMobile } from '../../common/Responsive'\nimport {\n  FFoodMenuRecipeFragment,\n  useExecutableQCartRecipe,\n} from '../../graph/generated'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { TFoodMenuPresence } from './hooks/useFoodMenuPresence'\n\ninterface IProps {\n  recipe: FFoodMenuRecipeFragment\n  presence: TFoodMenuPresence\n  onAddToCart(recipeId: ID, hasSideDish: boolean): void\n}\n\nconst StyledFoodMenuItem = styled.div`\n  padding: 1rem 0.5rem 0.3rem 1.1rem;\n  border: 1px solid #d5d5d5 !important;\n  margin: 0 0 0.4rem 0;\n  border-radius: 0.8rem;\n  position: relative;\n  min-height: 6rem;\n  user-select: none;\n  &:hover:not(.disabled) {\n    cursor: pointer;\n    background-color: #c9e8d7;\n  }\n  &.active {\n    background-color: #b3ebcc;\n  }\n  h4 {\n    font-size: 1rem;\n    font-weight: 700;\n    color: #404040;\n    margin-bottom: 0.1rem;\n    margin-right: 6rem;\n  }\n  p {\n    color: #666666;\n    margin: 0.6rem 0 0 0;\n    font-size: 0.9rem;\n    max-height: 2.5rem;\n    -webkit-line-clamp: 2;\n    overflow: hidden;\n  }\n\n  & div.presence {\n    background-color: ${({ theme }) => theme.secondary};\n    float: left;\n    position: absolute;\n    left: -1.2rem;\n    padding: 0.4rem 0.6rem;\n    color: white;\n    border-radius: 1.8rem;\n    font-size: 0.9rem;\n    ${mediaMobile`\n    left: -0.6rem;\n    top: -0.7rem;\n  `};\n  }\n`\nconst FoodMenuItemImage = styled.img`\n  width: 6rem;\n  height: 6rem;\n  display: block;\n  float: left;\n  margin: -1.05rem 1rem 0 -1.2rem;\n  border-radius: 0.8rem 0 0 0.8rem;\n  object-fit: cover;\n`\n\nconst FoodMenuItemPriceCorner = styled.div`\n  border-top-width: 1.8rem;\n  border-top-style: solid;\n  border-top-color: ${({ theme }) => theme.primary} !important;\n  position: absolute;\n  right: 4.799rem;\n  top: 1rem;\n  width: 0;\n  height: 0;\n  border-left: 1.8rem solid transparent;\n`\n\nconst FoodMenuItemPrice = styled.div`\n  background-color: ${({ theme }) => theme.primary} !important;\n  position: absolute;\n  right: 0;\n  top: 1rem;\n  width: 4.8rem;\n  height: 1.8rem;\n  padding: 0.12rem 0.7rem 0.3rem 0rem;\n  font-weight: 500;\n  font-size: 1.1rem;\n  color: white;\n  text-align: right;\n  overflow: hidden;\n  white-space: nowrap;\n`\n\nconst FoodMenuItem = React.memo<IProps>(({ recipe, presence, onAddToCart }) => {\n  const orderModel = useOrderModel()\n\n  const hasSideDishes = recipe.sideDishCount > 0\n\n  const onClick = React.useCallback(() => {\n    onAddToCart(recipe.id, hasSideDishes)\n  }, [hasSideDishes, onAddToCart, recipe.id])\n\n  const [prefetchFoodItem] = useExecutableQCartRecipe({\n    fetchPolicy: 'cache-first',\n  })\n\n  const onMouseEnter = React.useCallback(() => {\n    if (process.env.NODE_ENV !== 'development' && hasSideDishes) {\n      prefetchFoodItem({ recipeId: recipe.id })\n    }\n  }, [hasSideDishes, prefetchFoodItem, recipe.id])\n\n  const previousPresence = React.useRef(-1)\n\n  const renderPresence = () => {\n    const recipePresence = presence.get(recipe.id)\n    if (!recipePresence) {\n      previousPresence.current = -1\n      return null\n    }\n    const className = cn('presence', 'animated', {\n      pulse: recipePresence > 1 || previousPresence.current > 0,\n      zoomIn:\n        (recipePresence === 1 && previousPresence.current === 0) ||\n        previousPresence.current === -1,\n    })\n    previousPresence.current = recipePresence\n    return (\n      <div\n        key={recipePresence}\n        className={className}\n      >{`${recipePresence}x`}</div>\n    )\n  }\n\n  return useObserver(() => (\n    <StyledFoodMenuItem\n      onClick={onClick}\n      onMouseEnter={onMouseEnter}\n      className={cn({\n        active: orderModel.lastActiveRecipeId === recipe.id,\n        disabled: orderModel.disableInteraction,\n      })}\n      data-testid={`foodMenuItem__${recipe.id}`}\n    >\n      {recipe.image && (\n        <FoodMenuItemImage src={recipe.image} alt={recipe.nameLabel} />\n      )}\n\n      <FoodMenuItemPriceCorner />\n      <FoodMenuItemPrice data-testid={`foodMenuItem__Price__${recipe.id}`}>\n        {recipe.price.formattedValue}\n      </FoodMenuItemPrice>\n      {renderPresence()}\n      <h4 title={recipe.nameLabel}>\n        <Truncate lines={2} data-testid={`foodMenuItem__Name__${recipe.id}`}>\n          {recipe.nameLabel}\n        </Truncate>\n      </h4>\n      <p>\n        <Truncate\n          lines={2}\n          data-testid={`foodMenuItem__Description__${recipe.id}`}\n        >\n          {recipe.descriptionLabel}\n        </Truncate>\n      </p>\n    </StyledFoodMenuItem>\n  ))\n})\n\nexport default FoodMenuItem\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport Pacman from '../../common/Pacman'\nimport { mediaDesktop, mediaMobile } from '../../common/Responsive'\nimport { QFoodMenuWareCategories } from '../../graph/generated'\nimport { useAddToCart } from '../../hooks/useAddToCart'\nimport FoodCategory from './FoodCategory'\nimport FoodMenuItem from './FoodMenuItem'\nimport { useFoodMenuPresence } from './hooks/useFoodMenuPresence'\n\ninterface IProps {\n  orderId: MaybeID\n  categories: ReadonlyArray<QFoodMenuWareCategories>\n  isLoading: boolean\n}\n\nconst StyledFoodMenu = styled.div`\n  border-radius: 0 0 0.6rem 0.6rem;\n  ${mediaDesktop`background: white;`};\n  ${mediaMobile`\n    background: #eee9e7;\n    background-size: cover;\n    background-attachment: scroll;\n  `};\n\n  & > div {\n    ${mediaDesktop`\n      margin: 0 1.4rem 1rem 1.6rem;\n      padding: 2rem 0 2rem 0;\n    `};\n    ${mediaMobile`\n      margin: 0 0.7rem 1rem 0.7rem;\n      padding: 0 0 4rem 0;\n    `};\n  }\n`\n\nconst FoodMenu: React.FC<IProps> = ({ orderId, categories, isLoading }) => {\n  const { order: orderModel, config, user } = useRoot()\n\n  const presence = useFoodMenuPresence(orderId)\n\n  const executeAddToCart = useAddToCart()\n  const onAddToCart = React.useCallback(\n    (recipeId: ID, hasSideDish: boolean) => {\n      if (orderModel.disableInteraction) {\n        return\n      }\n      if (presence.size >= config.orderItemsMax) {\n        user.showOrderLimit()\n      } else if (hasSideDish) {\n        orderModel.addToCart(recipeId)\n      } else {\n        orderModel.setUsedRecipeId(recipeId)\n        executeAddToCart(recipeId)\n      }\n    },\n    [config.orderItemsMax, executeAddToCart, orderModel, presence, user],\n  )\n\n  const render = () => {\n    if (isLoading) {\n      return <Pacman noMargin={true} />\n    }\n    if (categories.length === 0) {\n      return (\n        <h3>\n          <Trans>Food menu is empty. We are sorry.</Trans>\n        </h3>\n      )\n    }\n    return (\n      <>\n        {categories.map(category => (\n          <FoodCategory key={category.id} category={category}>\n            {category.recipes.map(recipe => (\n              <FoodMenuItem\n                key={recipe.id}\n                recipe={recipe}\n                presence={presence}\n                onAddToCart={onAddToCart}\n              />\n            ))}\n          </FoodCategory>\n        ))}\n      </>\n    )\n  }\n\n  return (\n    <StyledFoodMenu data-testid=\"FoodMenu\">\n      <div>{render()}</div>\n    </StyledFoodMenu>\n  )\n}\n\nexport default React.memo(FoodMenu)\n","import { observable, ObservableMap, runInAction } from 'mobx'\nimport React from 'react'\n\nimport { useQFoodMenuCartPresence } from '../../../graph/generated'\n\nexport function useFoodMenuPresence(orderId: MaybeID) {\n  const { data, loading } = useQFoodMenuCartPresence(\n    {\n      orderId: orderId!,\n    },\n    {\n      skip: !orderId,\n      fetchPolicy: 'cache-only',\n    },\n  )\n\n  const [presence] = React.useState(() => observable.map<ID, number>())\n\n  if (!loading) {\n    runInAction(() => {\n      presence.clear()\n      data.order.presence.forEach(({ recipe: { id } }) => {\n        if (!presence.has(id)) {\n          presence.set(id, 0)\n        }\n        presence.set(id, presence.get(id)! + 1)\n      })\n    })\n  }\n\n  return presence\n}\n\nexport type TFoodMenuPresence = ObservableMap<ID, number>\n","import { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../app/useRoot'\nimport { AlertModal } from '../../common/AlertModal'\nimport { i18n } from '../../i18n'\n\nexport const OrderLimitModal: React.FC = () => {\n  const { user } = useRoot()\n  return useObserver(() => (\n    <AlertModal\n      isOpen={!user.orderLimitAlertHidden}\n      onClose={user.hideOrderLimit}\n      headerText={i18n.t`Limit has been reached`}\n    >\n      {i18n.t`The maximum number of items in the order has been reached`}\n    </AlertModal>\n  ))\n}\n","import { Trans } from '@lingui/macro'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport { Link } from 'react-router-dom'\nimport { Alert } from 'reactstrap'\nimport styled from 'styled-components'\n\nimport { SecondaryButton } from '../../common/Buttons'\nimport { useOrderModel } from '../../hooks/useOrderModel'\n\ninterface IProps {}\n\nconst StyledOrderLocked = styled(Alert)`\n  font-weight: bold;\n  margin-bottom: 0;\n  padding: 0.5rem 1rem;\n\n  & button {\n    margin: 0.5rem;\n  }\n`\n\nexport const OrderLocked: React.FC<IProps> = () => {\n  const orderModel = useOrderModel()\n  return useObserver(() => {\n    if (!orderModel.disableInteraction) {\n      return null\n    }\n\n    return (\n      <StyledOrderLocked color=\"warning\">\n        <Trans>Order is locked for further changes.</Trans>\n        <Link to=\"/\">\n          <SecondaryButton>\n            <Trans>Create new order</Trans>\n          </SecondaryButton>\n        </Link>\n      </StyledOrderLocked>\n    )\n  })\n}\n","import { useReaction } from '@speedlo/hooks'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { useRoot } from '../../app/useRoot'\nimport CategoryNavigator from './CategoryNavigator'\nimport FoodMenu from './FoodMenu'\nimport { useFoodMenuQuery } from './hooks/useFoodMenuQuery'\nimport { OrderLimitModal } from './OrderLimitModal'\nimport { OrderLocked } from './OrderLocked'\n\nconst StyledMobileHeader = styled.div`\n  position: sticky;\n  top: 0;\n  z-index: 4;\n`\n\nexport const FoodMenuView = observer(() => {\n  const { order: orderModel, user } = useRoot()\n\n  const { data, loading, refetch } = useFoodMenuQuery(orderModel.branchId)\n\n  useReaction(() => user.language, () => refetch())\n\n  const categories = React.useMemo(\n    () =>\n      loading ? [] : data.wareCategories.filter(cat => cat.recipes.length > 0),\n    [loading, data],\n  )\n\n  return (\n    <>\n      <OrderLimitModal />\n      <StyledMobileHeader>\n        <OrderLocked />\n        <CategoryNavigator categories={categories} />\n      </StyledMobileHeader>\n\n      <FoodMenu\n        orderId={orderModel.orderId}\n        categories={categories}\n        isLoading={loading}\n      />\n    </>\n  )\n})\n","import React from 'react'\nimport { FormGroup } from 'reactstrap'\n\nimport { FormTextInput } from '../../forms/FormTextInput'\nimport { i18n } from '../../i18n'\n\nexport const OrderEmailInput: React.FC = () => (\n  <FormGroup>\n    <FormTextInput\n      name=\"email\"\n      type=\"email\"\n      autoComplete=\"email\"\n      placeholder={i18n.t`E-mail`}\n    />\n  </FormGroup>\n)\n","import React from 'react'\nimport { FormGroup, InputGroup } from 'reactstrap'\n\nimport { FormTextInput } from '../../forms/FormTextInput'\nimport { i18n } from '../../i18n'\n\nexport const OrderNameInput: React.FC = () => (\n  <FormGroup>\n    <InputGroup>\n      <FormTextInput\n        name=\"firstname\"\n        autoComplete=\"given-name\"\n        placeholder={i18n.t`First name`}\n      />\n      <FormTextInput\n        name=\"lastname\"\n        autoComplete=\"family-name\"\n        placeholder={i18n.t`Last name`}\n      />\n    </InputGroup>\n  </FormGroup>\n)\n","import React from 'react'\nimport { FormGroup, FormText } from 'reactstrap'\n\nimport { FormTextInput } from '../../forms/FormTextInput'\nimport { i18n } from '../../i18n'\n\nexport const OrderNoteInput: React.FC = () => {\n  const ingredientsDescription = i18n.t`eg. ingredients change, company...`\n  return (\n    <FormGroup>\n      <FormTextInput\n        name=\"note\"\n        type=\"textarea\"\n        placeholder={i18n.t`Note`}\n        title={ingredientsDescription}\n        errorForceDisplay={true}\n      />\n      <FormText>{ingredientsDescription}</FormText>\n    </FormGroup>\n  )\n}\n","import { useAutorun } from '@speedlo/hooks'\nimport { useXFieldState } from '@speedlo/xform'\nimport React from 'react'\nimport { FormGroup, InputGroup } from 'reactstrap'\nimport { UAParser } from 'ua-parser-js'\n\nimport { FormTextInput } from '../../forms/FormTextInput'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { i18n } from '../../i18n'\n\nexport const OrderPhoneInput: React.FC = () => {\n  const agent = new UAParser(window.navigator.userAgent)\n  const isMobileSafari = agent.getBrowser().name === 'Mobile Safari'\n\n  const orderModel = useOrderModel()\n  const prefixField = useXFieldState<string>('phonePrefix')\n\n  useAutorun(() => {\n    const prefix = orderModel.defaultPhonePrefix\n    if (\n      prefix &&\n      orderModel.root.user.memoryApplied &&\n      prefixField.value.length === 0\n    ) {\n      prefixField.setValue(prefix)\n      if (prefix) {\n        prefixField.setTouched()\n      }\n    }\n  })\n\n  return (\n    <FormGroup>\n      <InputGroup>\n        <FormTextInput\n          name=\"phonePrefix\"\n          autoComplete={isMobileSafari ? 'off' : 'tel-country-code'}\n          placeholder=\"Prefix\"\n        />\n        <FormTextInput\n          name=\"phone\"\n          type=\"tel\"\n          autoComplete=\"tel-national\"\n          placeholder={i18n.t`Phone`}\n          style={{ width: '55%' }}\n        />\n      </InputGroup>\n    </FormGroup>\n  )\n}\n","import React from 'react'\n\nimport { OrderEmailInput } from './OrderEmailInput'\nimport { OrderNameInput } from './OrderNameInput'\nimport { OrderNoteInput } from './OrderNoteInput'\nimport { OrderPhoneInput } from './OrderPhoneInput'\n\nexport const OrderFormInputs = () => (\n  <>\n    <OrderNameInput />\n    <OrderPhoneInput />\n    <OrderEmailInput />\n    <OrderNoteInput />\n  </>\n)\n","import { cn } from '@speedlo/ui'\nimport { useXField } from '@speedlo/xform'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport { Input } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\ninterface IProps extends React.InputHTMLAttributes<HTMLInputElement> {\n  name: string\n  children: ReactNode\n}\n\nexport const StyledFormCheckbox = styled.div`\n  display: flex;\n  margin-bottom: 0.5rem;\n\n  input {\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    background-color: white;\n    border: 1px solid;\n    border-color: #c5c5c5;\n    width: 2rem;\n    height: 2rem;\n    min-width: 2rem;\n    border-radius: 0.25rem;\n    position: relative;\n    margin: 0;\n    outline: none;\n    &:checked {\n      background-color: white;\n    }\n    &:checked:after {\n      content: '\\\\2714';\n      font-size: 2rem;\n      position: absolute;\n      top: -0.5rem;\n      left: 0.1rem;\n      color: #1d1d1d;\n      overflow: hidden;\n    }\n    &.is-invalid {\n      border-color: red;\n    }\n  }\n  label {\n    margin: 0 0 0 0.8rem;\n    vertical-align: top;\n  }\n`\n\nexport const FormCheckbox: React.FC<IProps> = ({\n  name,\n  children,\n  ...element\n}) => {\n  const field = useXField(name)\n  return useObserver(() => (\n    <StyledFormCheckbox\n      className={cn({ 'is-invalid': field.touched && Boolean(field.error) })}\n    >\n      <Input\n        {...element}\n        id={field.name}\n        name={field.name}\n        checked={field.value === true}\n        onChange={() => field.setValue(!field.value)}\n        type=\"checkbox\"\n      />\n      <label htmlFor={name}>{children}</label>\n    </StyledFormCheckbox>\n  ))\n}\n","import { IAgreementBoxProps } from '@speedlo/ui'\nimport { observer } from 'mobx-react-lite'\nimport React from 'react'\nimport { Button, Collapse, Input } from 'reactstrap'\nimport styled from 'styled-components/macro'\n\nimport { StyledFormCheckbox } from '../../forms/FormCheckbox'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { i18n } from '../../i18n'\n\nconst StyledOrderAgreementBox = styled.div`\n  button {\n    padding: 0 0.5rem;\n    font-size: 0.8rem;\n    min-width: 5rem;\n    color: darkgray;\n  }\n  div.description {\n    font-size: 0.8rem !important;\n    color: darkgray;\n    margin: 0.5rem 0 0.5rem 0;\n    & .row {\n      margin: 0;\n    }\n  }\n`\n\nexport const OrderAgreementBox = observer<IAgreementBoxProps>(\n  ({\n    agreement,\n    isValid,\n    isCollapsed,\n    titleNode,\n    descriptionNode,\n    inputProps,\n    buttonProps,\n  }) => {\n    const orderModel = useOrderModel()\n    const id = `agreement-${agreement.id}`\n\n    return (\n      <StyledOrderAgreementBox>\n        <StyledFormCheckbox>\n          <Input\n            {...inputProps}\n            id={id}\n            type=\"checkbox\"\n            disabled={orderModel.disableInteraction}\n            invalid={!isValid}\n            onInvalid={ev => {\n              if (!isValid) {\n                ;(ev.target as HTMLInputElement).setCustomValidity(\n                  i18n.t`Please check this box if you want to proceed.`,\n                )\n              }\n            }}\n            onClick={ev => {\n              ;(ev.target as HTMLInputElement).setCustomValidity('')\n            }}\n            data-testid={`OrderAgreement${\n              agreement.isMandatory ? 'Mandatory' : ''\n            }`}\n          />\n          <label htmlFor={id}>\n            {titleNode}\n            {agreement.isMandatory && ' * '}\n          </label>\n          <Button {...buttonProps} color=\"link\">\n            {isCollapsed\n              ? i18n.t`More...`.toLocaleLowerCase()\n              : i18n.t`Less`.toLocaleLowerCase()}\n          </Button>\n        </StyledFormCheckbox>\n        <Collapse isOpen={!isCollapsed} className=\"description\">\n          {descriptionNode}\n        </Collapse>\n      </StyledOrderAgreementBox>\n    )\n  },\n)\n","import { Trans } from '@lingui/macro'\nimport { useAutorun } from '@speedlo/hooks'\nimport { useVamAgreements } from '@speedlo/ui'\nimport { useXField, useXFormState } from '@speedlo/xform'\nimport { debounce } from 'debounce'\nimport { autorun } from 'mobx'\nimport React from 'react'\n\nimport {\n  QOrderFormAgreementsVariables,\n  useQOrderFormAgreements,\n} from '../../graph/generated'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { OrderAgreementBox } from './OrderAgreementBox'\nimport { OrderFormValues, TAgreement } from './OrderFormSetup'\n\nconst EMPTY_ARRAY = []\n\nexport const OrderAgreements: React.FC = () => {\n  const orderModel = useOrderModel()\n\n  const formState = useXFormState<OrderFormValues>()\n  const [variables, setVariables] = React.useState<\n    QOrderFormAgreementsVariables\n  >()\n\n  React.useEffect(() => {\n    const updateVariablesLater = debounce(setVariables, 2000)\n\n    function extractVariables() {\n      const { firstname, lastname, phonePrefix, phone } = formState.values\n      return {\n        input: {\n          orderId: orderModel.orderId!,\n          firstname,\n          lastname,\n          phone: `${phonePrefix.trim()}${phone.trim()}`,\n        },\n      }\n    }\n\n    const dispose = autorun(() => {\n      updateVariablesLater(extractVariables())\n    })\n\n    return () => {\n      dispose()\n      updateVariablesLater.clear()\n    }\n  }, [formState, orderModel])\n\n  const { data, errors, loading } = useQOrderFormAgreements(variables, {\n    skip: !variables,\n  })\n\n  // remember latest agreements to prevent rendering to blank on update of form values\n  const agreements = React.useRef<RoA<TAgreement>>(EMPTY_ARRAY)\n  const hasFailed = errors && errors.length > 0\n\n  if (!(loading || hasFailed)) {\n    agreements.current = data.agreements\n  }\n\n  React.useEffect(() => {\n    if (agreements.current.length > 0 && !orderModel.isVamInitialized) {\n      orderModel.initVam()\n    }\n  })\n\n  const { state, renderVamAgreements } = useVamAgreements(agreements.current)\n\n  const validate = React.useCallback(() => {\n    const result = agreements.current.some(agreement => {\n      return (\n        agreement.isMandatory && !state.confirmedAgreements.has(agreement.id)\n      )\n    })\n    return result ? 'mandatory' : undefined\n  }, [state])\n\n  const field = useXField('agreements', { validate })\n\n  useAutorun(() => {\n    // confirmed agreements are stored in field to be collected for a submission later\n    const confirmed = Array.from(state.confirmedAgreements)\n    field.setValue(confirmed)\n  })\n\n  if (hasFailed) {\n    return (\n      <Trans>\n        Failed retrieving company agreements. Please try again later or contact\n        us.\n      </Trans>\n    )\n  }\n\n  return renderVamAgreements({ AgreementBox: OrderAgreementBox })\n}\n","import './CartView.css'\n\nimport { Trans } from '@lingui/macro'\nimport { CartLabels, useCartSystem } from '@speedlo/cart'\nimport { autorun } from 'mobx'\nimport { useObserver } from 'mobx-react-lite'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { useTheme } from '../../app/ThemeSwitchProvider'\nimport { useRoot } from '../../app/useRoot'\nimport { PrimaryButton } from '../../common/Buttons'\nimport { ButtonStrip } from '../../common/ButtonStrip'\nimport { mobileBreakpoint } from '../../common/Responsive'\nimport { useQCart } from '../../graph/generated'\nimport { useOrderModel } from '../../hooks/useOrderModel'\nimport { useCartControl } from './hooks/useCartControl'\n\ninterface IProps {\n  orderId: MaybeID\n  isReadonly: boolean\n  isMobileConfirm?: boolean\n}\n\nconst StyledCartSystem = styled.div`\n  & .animated {\n    z-index: 10;\n  }\n`\n\nexport const CartSystem: React.FC<IProps> = ({\n  orderId,\n  isReadonly,\n  isMobileConfirm = false,\n}) => {\n  const theme = useTheme()\n  const labels = React.useMemo(getCartLabels, [])\n  const orderModel = useOrderModel()\n\n  const {\n    cartModel,\n    onItemEdit,\n    onItemRemove,\n    onPlaceOrder,\n    onChangeOrder,\n  } = useCartControl()\n\n  const renderMobileSubmit = React.useCallback(() => {\n    if (isMobileConfirm && orderModel.disableInteraction) {\n      return null\n    }\n    const shouldPlaceOrder = !isReadonly || orderModel.disableInteraction\n    return (\n      <ButtonStrip>\n        <PrimaryButton\n          onClick={shouldPlaceOrder ? onPlaceOrder : onChangeOrder}\n        >\n          {shouldPlaceOrder ? (\n            <Trans>Place order</Trans>\n          ) : (\n            <Trans>Change order</Trans>\n          )}\n        </PrimaryButton>\n      </ButtonStrip>\n    )\n  }, [isMobileConfirm, isReadonly, onChangeOrder, onPlaceOrder, orderModel])\n\n  const renderGoodsLoading = React.useCallback(\n    () => <Trans>Accessing your order</Trans>,\n    [],\n  )\n\n  const cart = useCartSystem({\n    colors: {\n      primary: theme.primary,\n      sumRowBg: theme.primary,\n      sumRowText: 'white',\n      mobileSummaryItemCount: theme.secondary,\n    },\n    labels,\n    isReadonly,\n    mobileBreakpoint,\n    backgroundImage: theme.backgroundCart,\n    onItemEdit,\n    onItemRemove,\n    renderMobileSubmit,\n    renderGoodsLoading,\n  })\n\n  React.useEffect(\n    () =>\n      autorun(() => {\n        cartModel.updateDisplay(cart.store.isMobile, cart.store.showGoods)\n      }),\n    [cart.store, cartModel],\n  )\n\n  const root = useRoot()\n\n  return useObserver(function useObserverBody() {\n    const { data, loading } = useQCart(\n      {\n        orderId: orderId!,\n        withGoods: cartModel.withGoods,\n        withPresence: cartModel.withPresence,\n      },\n      {\n        skip: !root.initialized || !orderId,\n        context: {\n          noBatch: true,\n        },\n      },\n    )\n\n    React.useEffect(() => {\n      if (!loading) {\n        cart.updateSummary(data.order)\n        if (cartModel.withGoods) {\n          cart.updateGoods(data.order)\n        }\n      }\n    })\n\n    return <StyledCartSystem>{cart.renderCart()}</StyledCartSystem>\n  })\n}\n\nfunction getCartLabels(): CartLabels {\n  return {\n    noSideDish: <Trans>Without sidedish</Trans>,\n    noCost: <Trans>For free</Trans>,\n    cartSumHeader: totalPrice => (\n      <Trans>In the cart you have goods for {totalPrice}</Trans>\n    ),\n    emptyCart: <Trans>Cart is empty</Trans>,\n    totalDiscount: <Trans>Total discount</Trans>,\n    coverPrice: <Trans>Covers</Trans>,\n    transportFee: <Trans>Delivery</Trans>,\n    totalSum: <Trans>Total</Trans>,\n    tip: <Trans>Tip</Trans>,\n    minimalOrderPrice: price => (\n      <Trans>Minimal price of order is {price}</Trans>\n    ),\n  }\n}\n","import { useApolloClient } from '@speedlo/graphql'\nimport { useRouterContext } from '@speedlo/hooks'\nimport { idPropEq, RM } from '@speedlo/tools'\nimport React from 'react'\n\nimport { useRoot } from '../../../app/useRoot'\nimport {\n  MRemoveCartItemMutation,\n  MRemoveCartItemVariables,\n  QCartDocument,\n  QCartQuery,\n  QCartVariables,\n  useMRemoveCartItem,\n} from '../../../graph/generated'\n\nexport function useCartControl() {\n  const { order: orderModel, cart: cartModel } = useRoot()\n  const client = useApolloClient()\n  const { history } = useRouterContext()\n  const onItemEdit = React.useCallback(\n    (item: ID) => {\n      orderModel.changeCartItem(item)\n    },\n    [orderModel],\n  )\n\n  const [removeItem] = useMRemoveCartItem()\n\n  const onItemRemove = React.useCallback(\n    (item: ID) => {\n      const variables: MRemoveCartItemVariables = {\n        itemId: item,\n        withGoods: cartModel.withGoods,\n        withPresence: cartModel.withPresence,\n      }\n      removeItem(variables, {\n        optimisticResponse: makeOptimisticRemove(variables),\n        context: {\n          noBatch: true,\n        },\n      })\n    },\n    [cartModel, makeOptimisticRemove, removeItem],\n  )\n\n  const onPlaceOrder = React.useCallback(() => {\n    history.push('/confirm')\n  }, [history])\n\n  const onChangeOrder = React.useCallback(() => {\n    history.push('/order')\n  }, [history])\n\n  return { cartModel, onItemEdit, onItemRemove, onPlaceOrder, onChangeOrder }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  function makeOptimisticRemove(\n    variables: MRemoveCartItemVariables,\n  ): MRemoveCartItemMutation | undefined {\n    const current = client.readQuery<QCartQuery, QCartVariables>(\n      {\n        query: QCartDocument,\n        variables: {\n          orderId: orderModel.orderId!,\n          withGoods: cartModel.withGoods,\n          withPresence: cartModel.withPresence,\n        },\n      },\n      true,\n    )\n    if (!current) {\n      return undefined\n    }\n    const rejectItem = RM.reject(idPropEq(variables.itemId))\n    return {\n      __typename: 'Mutation',\n      remove: {\n        ...current.order,\n        countWares: current.order.countWares - 1,\n        totalSum: {\n          ...current.order.totalSum,\n          value: -1,\n        },\n        items: variables.withGoods\n          ? rejectItem(current.order.items)\n          : current.order.items,\n        presence: variables.withPresence\n          ? rejectItem(current.order.presence)\n          : current.order.presence,\n      },\n    }\n  }\n}\n","import { useObserver } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { SelectButtonThemed } from '../../../common/Buttons'\nimport { DeliveryTypeEnum } from '../../../graph/generated'\nimport { useOrderModel } from '../../../hooks/useOrderModel'\nimport { TOrderModel } from '../../../models/OrderModel'\n\ninterface IProps {\n  orderMethod: DeliveryTypeEnum\n  onChange(order: TOrderModel): void\n}\n\nexport const OrderMethodButton: React.FC<IProps> = ({\n  orderMethod,\n  onChange,\n  children,\n}) => {\n  const orderModel = useOrderModel()\n  return useObserver(() => (\n    <SelectButtonThemed\n      selected={orderModel.orderMethod === orderMethod}\n      onClick={() => {\n        orderModel.useOrderMethod(orderMethod)\n        onChange(orderModel)\n      }}\n      data-testid={`orderMethod-${orderMethod}`}\n      data-testselected={orderModel.orderMethod === orderMethod}\n    >\n      {children}\n    </SelectButtonThemed>\n  ))\n}\n","import { Trans } from '@lingui/react'\nimport { RM } from '@speedlo/tools'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { DeliveryTypeEnum } from '../../../graph/generated'\nimport { TOrderModel } from '../../../models/OrderModel'\nimport { OrderMethodButton } from './OrderMethodButton'\n\ninterface IProps {\n  onChange?(order: TOrderModel): void\n}\n\nconst StyledOrderMethod = styled.div`\n  padding: 0.2rem;\n\n  & button {\n    font-size: 1.3rem;\n    margin: 0.3rem 1rem 0.3rem 1rem;\n    padding: 0.3rem 1.2rem;\n    height: 2.7rem;\n    line-height: 1rem;\n    white-space: nowrap;\n\n    span:before {\n      margin: 0 0.8rem 0 0;\n      font-size: 2rem;\n      font-weight: initial;\n    }\n  }\n`\n\nexport const OrderMethod: React.FC<IProps> = ({ onChange = RM.identity }) => {\n  return (\n    <StyledOrderMethod>\n      <OrderMethodButton\n        orderMethod={DeliveryTypeEnum.Messenger}\n        onChange={onChange}\n      >\n        <span className=\"flaticon-transport\" />\n        <Trans>I want to deliver</Trans>\n      </OrderMethodButton>\n      <OrderMethodButton\n        orderMethod={DeliveryTypeEnum.Pickup}\n        onChange={onChange}\n      >\n        <span className=\"flaticon-restaurant\" />\n        <Trans>I'll pick up</Trans>\n      </OrderMethodButton>\n    </StyledOrderMethod>\n  )\n}\n","import { observer } from 'mobx-react-lite'\nimport React from 'react'\n\nimport { useRoot } from '../../app/useRoot'\nimport { SelectButtonThemed } from '../../common/Buttons'\nimport { PaymentGateEnum } from '../../graph/types'\n\nexport interface IPaymentButtonProps {\n  paymentMethod: PaymentGateEnum\n}\n\nexport const OrderPaymentButton = observer<IPaymentButtonProps>(\n  ({ children, paymentMethod }) => {\n    const { order: orderModel } = useRoot()\n    const isSelected = orderModel.paymentMethod === paymentMethod\n    return (\n      <SelectButtonThemed\n        disabled={orderModel.disableInteraction}\n        selected={isSelected}\n        onClick={() => {\n          orderModel.setPaymentMethod(paymentMethod)\n        }}\n        data-testid={`orderPaymentMethod-${paymentMethod}`}\n      >\n        <Checkmark show={isSelected} />\n        {children}\n      </SelectButtonThemed>\n    )\n  },\n)\n\nfunction Checkmark({ show }: { show: boolean }) {\n  return show ? (\n    <span className=\"flaticon-mark order__payment__method__button__checked\" />\n  ) : (\n    <div className=\"order__payment__method__button__unchecked\" />\n  )\n}\n","import { Trans } from '@lingui/macro'\nimport React from 'react'\nimport styled from 'styled-components/macro'\n\nimport { PaymentGateEnum } from '../../graph/generated'\nimport { OrderPaymentButton } from './OrderPaymentButton'\n\nconst StyledOrderPaymentMethod = styled.div`\n  margin: 0 0 1.4rem 0;\n  span::before {\n    margin-left: 0;\n    margin-right: 0.5rem;\n  }\n  button {\n    position: relative;\n    padding-top: 0.3rem;\n    margin-bottom: 0.2rem;\n    height: 2.8rem;\n  }\n  button:first-of-type {\n    margin-right: 0.8rem;\n  }\n  .order__payment__method__button__unchecked {\n    width: 1.75rem;\n    height: 1.4rem;\n    margin: 0;\n    display: inline-block;\n  }\n`\n\nexport const OrderPaymentMethod = React.memo(() => (\n  <StyledOrderPaymentMethod>\n    <OrderPaymentButton paymentMethod={PaymentGateEnum.Gopay}>\n      <span className=\"flaticon-credit-card\">\n        <Trans>Pay by card</Trans>\n      </span>\n    </OrderPaymentButton>\n    <OrderPaymentButton paymentMethod={PaymentGateEnum.Cash}>\n      <span className=\"flaticon-money\">\n        <Trans>Pay by cash</Trans>\n      </span>\n    </OrderPaymentButton>\n  </StyledOrderPaymentMethod>\n))\n"],"sourceRoot":""}